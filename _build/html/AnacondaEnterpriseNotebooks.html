<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1   Anaconda Enterprise Notebook Runbook &mdash; Anaconda Enterprise Runbooks 4.0-3 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0-3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Anaconda Enterprise Runbooks 4.0-3 documentation" href="index.html" />
    <link rel="next" title="1   Anaconda Cluster Runbook" href="AnacondaCluster.html" />
    <link rel="prev" title="1   Anaconda Repository Runbook" href="AnacondaRepository.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">


<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="anaconda-enterprise-notebook-runbook">
<h1>1&nbsp;&nbsp;&nbsp;Anaconda Enterprise Notebook Runbook<a class="headerlink" href="#anaconda-enterprise-notebook-runbook" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>Version: 4.0-3 | Aug 27, 2016</li>
</ul>
<div class="contents local topic" id="contents">
<ul class="auto-toc simple">
<li><a class="reference internal" href="#requirements" id="id3">1.1&nbsp;&nbsp;&nbsp;Requirements</a></li>
<li><a class="reference internal" href="#download-the-installers" id="id4">1.2&nbsp;&nbsp;&nbsp;Download the Installers</a></li>
<li><a class="reference internal" href="#gather-ip-addresses-or-fqdns" id="id5">1.3&nbsp;&nbsp;&nbsp;Gather IP addresses or FQDNs</a></li>
<li><a class="reference internal" href="#install-aen-server" id="id6">1.4&nbsp;&nbsp;&nbsp;Install AEN Server</a></li>
<li><a class="reference internal" href="#install-aen-gateway" id="id7">1.5&nbsp;&nbsp;&nbsp;Install AEN Gateway</a></li>
<li><a class="reference internal" href="#install-aen-compute" id="id8">1.6&nbsp;&nbsp;&nbsp;Install AEN Compute</a></li>
<li><a class="reference internal" href="#pam-authentication-optional" id="id9">1.7&nbsp;&nbsp;&nbsp;PAM Authentication (optional)</a></li>
</ul>
</div>
<p>Anaconda Enterprise Notebook (AEN) is a Python data analysis environment from
Continuum Analytics. Accessed through a browser, Anaconda Enterprise
Notebooks is a ready-to-use, powerful, fully-configured Python analytics
environment. We believe that programmers, scientists, and analysts
should spend their time analyzing data, not working to set up a system.
Data should be shareable, and analysis should be repeatable.
Reproducibility should extend beyond just code to include the runtime
environment, configuration, and input data.</p>
<p>Anaconda Enterprise Notebooks makes it easy to start your analysis
immediately.</p>
<p>This runbook walks through the steps needed to install a basic Anaconda
Enterprise Notebook system comprised of the front-end server, gateway,
and two compute machines. The runbook is designed for two audiences:
those who have direct access to the internet for installation and those
where such access is not available or restricted for security reasons.
For these restricted a.k.a. &#8220;Air Gap&#8221; environments, Continuum ships the
entire Anaconda product suite on portable storage medium or as a
downloadable TAR archive. Where necessary, additional instructions for
Air Gap environments are noted. If you have any questions about the
instructions, please contact your sales representative or Priority
Support team, if applicable, for additional assistance.</p>
<p><strong>AEN Server:</strong> The administrative front-end to the system. This is
where users login to the system, where user accounts are stored, and
where admins can manage the system.</p>
<p><strong>AEN Gateway:</strong> The gateway is a reverse proxy that authenticates
users and automatically directs them to the proper AEN Compute
machine for their project. Users will not notice this component as it
automatically routes them. One could put a gateway in each datacenter in
a tiered scale-out fashion.</p>
<p><strong>AEN Compute nodes:</strong> This is where projects are stored and run.
AEN Compute machines only need to be reachable by the AEN Gateway,
so they can be completely isolated by a firewall.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/wakari.png"><img alt="_images/wakari.png" class="align-center" src="_images/wakari.png" style="width: 816.0px; height: 1056.0px;" /></a>
</div></blockquote>
<div class="section" id="requirements">
<h2><a class="toc-backref" href="#id3">1.1&nbsp;&nbsp;&nbsp;Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="hardware-recommendations">
<h3>1.1.1&nbsp;&nbsp;&nbsp;Hardware Recommendations<a class="headerlink" href="#hardware-recommendations" title="Permalink to this headline">¶</a></h3>
<p><strong>AEN Server</strong></p>
<ul class="simple">
<li>2+GB RAM</li>
<li>2+CPU cores</li>
<li>20GB storage</li>
</ul>
<p><strong>AEN Gateway</strong></p>
<ul class="simple">
<li>2 GB RAM</li>
<li>2 CPU cores</li>
</ul>
<p><strong>AEN Compute</strong> (N-machines)</p>
<p>Configure to meet the needs of the projects. At least:</p>
<ul class="simple">
<li>2GB RAM</li>
<li>2 CPU cores</li>
<li>At least 20 GB</li>
</ul>
</div>
<div class="section" id="software-requirements">
<h3>1.1.2&nbsp;&nbsp;&nbsp;Software Requirements<a class="headerlink" href="#software-requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>RHEL/CentOS 6.7 on all nodes (Other operating systems are supported,
however this document assumes RHEL or CentOS 6.7)</li>
<li><strong>/opt/wakari:</strong> Ability to install here and at least 5GB of storage.</li>
<li><strong>/projects:</strong> Size depends on number and size of projects. At least
20GB of storage.</li>
<li><strong>ACL:</strong> This directory needs the filesystem mounted with Posix ACL
support (Posix.1e). Check with <code class="docutils literal"><span class="pre">mount</span></code> and
<code class="docutils literal"><span class="pre">tune2fs</span> <span class="pre">-l</span> <span class="pre">/path/to/filesystem</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">options</span></code></li>
</ul>
</div>
<div class="section" id="linux-system-accounts-required">
<h3>1.1.3&nbsp;&nbsp;&nbsp;Linux System Accounts Required<a class="headerlink" href="#linux-system-accounts-required" title="Permalink to this headline">¶</a></h3>
<p>Some Linux system accounts (UIDs) are added to the system during installation.
If your organization requires special actions, here is the list of UIDs:</p>
<ul class="simple">
<li>mongod (RHEL) or mongodb (Ubuntu/Debian): Created by the RPM or deb package</li>
<li>elasticsearch: created by RPM or deb package</li>
<li>nginx: created by RPM or deb package</li>
<li>wakari: Created during installation of Anaconda Enterprise Notebooks</li>
</ul>
</div>
<div class="section" id="software-prerequisites">
<h3>1.1.4&nbsp;&nbsp;&nbsp;Software Prerequisites<a class="headerlink" href="#software-prerequisites" title="Permalink to this headline">¶</a></h3>
<p><strong>AEN Server</strong></p>
<ul class="simple">
<li>Mongo Version: &gt;= 2.6.8 and &lt; 3.0</li>
<li>Nginx version: &gt;= 1.4.0</li>
<li>ElasticSearch</li>
<li>Oracle JRE 8</li>
</ul>
<p><strong>AEN Compute</strong></p>
<ul class="simple">
<li>git</li>
</ul>
</div>
<div class="section" id="security-requirements">
<h3>1.1.5&nbsp;&nbsp;&nbsp;Security Requirements<a class="headerlink" href="#security-requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>root or sudo access</li>
<li>SELinux in Permissive or Disabled mode - check with <code class="docutils literal"><span class="pre">getenforce</span></code></li>
</ul>
</div>
<div class="section" id="network-requirements">
<h3>1.1.6&nbsp;&nbsp;&nbsp;Network Requirements<a class="headerlink" href="#network-requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>TCP Ports</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="7%" />
<col width="12%" />
<col width="14%" />
<col width="14%" />
<col width="21%" />
<col width="17%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>direction</td>
<td>type</td>
<td>port</td>
<td>protocol</td>
<td>optional</td>
<td>configurable</td>
<td>comments</td>
</tr>
<tr class="row-even"><td>inbound</td>
<td>TCP</td>
<td>80</td>
<td>HTTP</td>
<td>No</td>
<td>No</td>
<td>Server</td>
</tr>
<tr class="row-odd"><td>in/out</td>
<td>TCP</td>
<td>8088</td>
<td>&nbsp;</td>
<td>No</td>
<td>No</td>
<td>Gateway</td>
</tr>
<tr class="row-even"><td>in/out</td>
<td>TCP</td>
<td>5002</td>
<td>&nbsp;</td>
<td>No</td>
<td>No</td>
<td>Compute</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Gateway port is updated from 8088 to 8089 in future versions</p>
</div>
</div>
<div class="section" id="other-requirements">
<h3>1.1.7&nbsp;&nbsp;&nbsp;Other Requirements<a class="headerlink" href="#other-requirements" title="Permalink to this headline">¶</a></h3>
<p>Assuming the above requirements are met, there are no additional
dependencies necessary for AEN.</p>
</div>
<div class="section" id="air-gap-vs-regular-installation">
<h3>1.1.8&nbsp;&nbsp;&nbsp;Air Gap vs. Regular Installation<a class="headerlink" href="#air-gap-vs-regular-installation" title="Permalink to this headline">¶</a></h3>
<p>As stated previously, this document contains installation instructions
for two audiences: those with internet access on the destination
server(s) and those who have no access to internet resources. Many of
the steps below have two sections: <strong>Air Gap Installation</strong> and
<strong>Regular Installation</strong>. Those without internet access should follow
the <strong>Air Gap Installation</strong> instructions and those with internet access
should follow <strong>Regular Installation</strong> instructions.</p>
</div>
<div class="section" id="air-gap">
<h3>1.1.9&nbsp;&nbsp;&nbsp;Air Gap<a class="headerlink" href="#air-gap" title="Permalink to this headline">¶</a></h3>
<p>Docs assume the air-gap data is avialable on target server at <cite>$INSTALLER_PATH</cite>. Refer to <a class="reference internal" href="AnacondaRepository.html#airgap"><span class="std std-ref">1.2.1&nbsp;&nbsp;&nbsp;Air Gap</span></a> for instructions
on obtaining AirGap archive for AE-N installation.</p>
<p>If the AE-N archive was not downloaded during AE-Repo install (<a class="reference internal" href="AnacondaRepository.html#airgap"><span class="std std-ref">1.2.1&nbsp;&nbsp;&nbsp;Air Gap</span></a>), then it can be obtained as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>nohup curl -O https://s3.amazonaws.com/continuum-airgap/2016-08/notebook-2016-08-04.tar
tar xfk notebook-2016-08-04.tar -C $INSTALLER_PATH --strip-components 2
mv $INSTALLER_PATH/anaconda-notebook $INSTALLER_PATH/wakari
</pre></div>
</div>
<p>AE-N archive contents:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$INSTALLER_PATH
mongodb-org-tools-2.6.8-1.x86_64.rpm
mongodb-org-shell-2.6.8-1.x86_64.rpm
mongodb-org-server-2.6.8-1.x86_64.rpm
mongodb-org-mongos-2.6.8-1.x86_64.rpm
mongodb-org-2.6.8-1.x86_64.rpm
wakari-compute-0.10.0-Linux-x86_64.sh
wakari-server-0.10.0-Linux-x86_64.sh
wakari-gateway-0.10.0-Linux-x86_64.sh
nginx-1.6.2-1.el6.ngx.x86_64.rpm
elasticsearch-1.7.2.noarch.rpm
jre-8u65-linux-x64.rpm
wakari/
</pre></div>
</div>
</div>
</div>
<div class="section" id="download-the-installers">
<h2><a class="toc-backref" href="#id4">1.2&nbsp;&nbsp;&nbsp;Download the Installers</a><a class="headerlink" href="#download-the-installers" title="Permalink to this headline">¶</a></h2>
<p>Download the installers and copy them to the corresponding servers.</p>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Copy installers from the Air Gap media</li>
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>RPM_CDN=&quot;https://820451f3d8380952ce65-4cc6343b423784e82fd202bb87cf87cf.ssl.cf1.rackcdn.com&quot;
curl -O $RPM_CDN/wakari-server-0.10.0-Linux-x86_64.sh
curl -O $RPM_CDN/wakari-gateway-0.10.0-Linux-x86_64.sh
curl -O $RPM_CDN/wakari-compute-0.10.0-Linux-x86_64.sh
</pre></div>
</div>
</div>
<div class="section" id="gather-ip-addresses-or-fqdns">
<h2><a class="toc-backref" href="#id5">1.3&nbsp;&nbsp;&nbsp;Gather IP addresses or FQDNs</a><a class="headerlink" href="#gather-ip-addresses-or-fqdns" title="Permalink to this headline">¶</a></h2>
<p>AEN is very sensitive to the IP address or domain name used to
connect to the Server and Gateway components. If users will be using the
domain name, you should install thecomponents using the domain name
instead of the IP addresses. The authentication systemrequires the
proper hostnames when authenticating users between the services.</p>
<p>Fill in the domain names or IP addresses of the components below and
record the auto­generated wakari password in the box below after
installing the AEN Server component.</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Component     | Name or IP address</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="2">AEN Server    |</td>
</tr>
<tr class="row-odd"><td colspan="2">AEN Gateway   |</td>
</tr>
<tr class="row-even"><td colspan="2">AEN Compute   |</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="install-aen-server">
<h2><a class="toc-backref" href="#id6">1.4&nbsp;&nbsp;&nbsp;Install AEN Server</a><a class="headerlink" href="#install-aen-server" title="Permalink to this headline">¶</a></h2>
<p>The AEN server is the administrative front­end to the system. This is
where users login to the system, where user accounts are stored, and
where admins can manage the system.</p>
<div class="section" id="aen-server-preparation-prerequisites">
<h3>1.4.1&nbsp;&nbsp;&nbsp;AEN Server Preparation ­Prerequisites<a class="headerlink" href="#aen-server-preparation-prerequisites" title="Permalink to this headline">¶</a></h3>
<div class="section" id="download-prerequisite-rpms">
<h4>1.4.1.1&nbsp;&nbsp;&nbsp;Download Prerequisite RPMs<a class="headerlink" href="#download-prerequisite-rpms" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Copy RPMs from the Air Gap media</li>
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>RPM_CDN=&quot;https://820451f3d8380952ce65-4cc6343b423784e82fd202bb87cf87cf.ssl.cf1.rackcdn.com&quot;
curl -O $RPM_CDN/nginx-1.6.2-1.el6.ngx.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-tools-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-shell-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-server-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-mongos-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/elasticsearch-1.7.2.noarch.rpm
curl -O $RPM_CDN/jre-8u65-linux-x64.rpm
</pre></div>
</div>
</div>
<div class="section" id="install-prerequisite-rpms">
<h4>1.4.1.2&nbsp;&nbsp;&nbsp;Install Prerequisite RPMs<a class="headerlink" href="#install-prerequisite-rpms" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="o">*.</span><span class="n">rpm</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">mongod</span> <span class="n">start</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">elasticsearch</span> <span class="n">stop</span>
<span class="n">sudo</span> <span class="n">chkconfig</span> <span class="o">--</span><span class="n">add</span> <span class="n">elasticsearch</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-the-aen-server-installer">
<h3>1.4.2&nbsp;&nbsp;&nbsp;Run the AEN Server Installer<a class="headerlink" href="#run-the-aen-server-installer" title="Permalink to this headline">¶</a></h3>
<div class="section" id="set-variables-and-change-permissions">
<h4>1.4.2.1&nbsp;&nbsp;&nbsp;Set Variables and Change Permissions<a class="headerlink" href="#set-variables-and-change-permissions" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">AEN_SERVER</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span> <span class="c1"># Use the real FQDN</span>
<span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="n">wakari</span><span class="o">-*.</span><span class="n">sh</span>                <span class="c1"># Set installer to be executable</span>
</pre></div>
</div>
</div>
<div class="section" id="run-aen-server-installer">
<h4>1.4.2.2&nbsp;&nbsp;&nbsp;Run AEN Server Installer<a class="headerlink" href="#run-aen-server-installer" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>sudo ./wakari-server-0.10.0-Linux-x86_64.sh -w $AEN_SERVER
&lt;license text&gt;
...
...

PREFIX=/opt/wakari/wakari-server
Logging to /tmp/wakari_server.log
Checking server name
Ready for pre-install steps
Installing miniconda
...
...
Checking server name
Loading config from /opt/wakari/wakari-server/etc/wakari/config.json
Loading config from /opt/wakari/wakari-server/etc/wakari/wk-server-config.json


===================================

Created password &#39;&lt;RANDOM_PASSWORD&gt;&#39; for user &#39;wakari&#39;

===================================


Starting Wakari daemons...
installation finished.
</pre></div>
</div>
<p>After successfully completing the installation script, the installer
will create the administrator account (wakari user) and assign it a
password:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Created</span> <span class="n">password</span> <span class="s1">&#39;&lt;RANDOM_PASSWORD&gt;&#39;</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;wakari&#39;</span>
</pre></div>
</div>
<p><strong>Record this password.</strong> It will be needed in the following steps. It
is also available in the installation log file found at
<code class="docutils literal"><span class="pre">/tmp/wakari_server.log</span></code></p>
</div>
<div class="section" id="start-elasticsearch">
<h4>1.4.2.3&nbsp;&nbsp;&nbsp;Start ElasticSearch<a class="headerlink" href="#start-elasticsearch" title="Permalink to this headline">¶</a></h4>
<p>Start elasticsearch to read the new config file</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">elasticsearch</span> <span class="n">start</span>
</pre></div>
</div>
</div>
<div class="section" id="test-the-aen-server-install">
<h4>1.4.2.4&nbsp;&nbsp;&nbsp;Test the AEN Server install<a class="headerlink" href="#test-the-aen-server-install" title="Permalink to this headline">¶</a></h4>
<p>Visit <a class="reference external" href="http://$AEN_SERVER">http://$AEN_SERVER</a>. You should be shown the <strong>&#8220;license
expired&#8221;</strong> page.</p>
</div>
<div class="section" id="update-the-license">
<h4>1.4.2.5&nbsp;&nbsp;&nbsp;Update the License<a class="headerlink" href="#update-the-license" title="Permalink to this headline">¶</a></h4>
<p>From the <strong>&#8220;license expired&#8221;</strong> page, follow the onscreen instructions to
upload your license file. After submitting, you should see the login
page.</p>
</div>
</div>
</div>
<div class="section" id="install-aen-gateway">
<h2><a class="toc-backref" href="#id7">1.5&nbsp;&nbsp;&nbsp;Install AEN Gateway</a><a class="headerlink" href="#install-aen-gateway" title="Permalink to this headline">¶</a></h2>
<p>The gateway is a reverse proxy that authenticates users and
automatically directs them to the proper AEN Compute machine for
their project. Users will not notice this component as it automatically
routes them.</p>
<div class="section" id="id1">
<h3>1.5.1&nbsp;&nbsp;&nbsp;Set Variables and Change Permissions<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">AEN_SERVER</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span> <span class="c1"># Use the real FQDN</span>
<span class="n">export</span> <span class="n">AEN_GATEWAY_PORT</span><span class="o">=</span><span class="mi">8088</span>
<span class="n">export</span> <span class="n">AEN_GATEWAY</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span>  <span class="c1"># will be needed shortly</span>
<span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="n">wakari</span><span class="o">-*.</span><span class="n">sh</span>                <span class="c1"># Set installer to be executable</span>
</pre></div>
</div>
</div>
<div class="section" id="run-wakari-gateway-installer">
<h3>1.5.2&nbsp;&nbsp;&nbsp;Run Wakari Gateway Installer<a class="headerlink" href="#run-wakari-gateway-installer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span>sudo ./wakari-gateway-0.10.0-Linux-x86_64.sh -w $AEN_SERVER
&lt;license text&gt;
...
...

PREFIX=/opt/wakari/wakari-gateway
Logging to /tmp/wakari_gateway.log
...
...
Checking server name
Please restart the Gateway after running the following command
to connect this Gateway to the AEN Server
...
</pre></div>
</div>
<p><strong>NOTE:</strong> replace <strong>password</strong> with the password of the wakari user that
was generated during server installation.</p>
</div>
<div class="section" id="register-the-aen-gateway">
<h3>1.5.3&nbsp;&nbsp;&nbsp;Register the AEN Gateway<a class="headerlink" href="#register-the-aen-gateway" title="Permalink to this headline">¶</a></h3>
<p>The AEN Gateway needs to register with the AEN Server. This needs
to be authenticated, so the wakari user’s credentials created during the
AEN Server install need to be used. <strong>This needs to be run as sudo or root</strong>
to write the configuration file:
<code class="docutils literal"><span class="pre">/opt/wakari/wakari-gateway/etc/wakari/wk-gateway-config.json</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span>sudo /opt/wakari/wakari-gateway/bin/wk-gateway-configure \
--server http://$AEN_SERVER --host $AEN_GATEWAY \
--port $AEN_GATEWAY_PORT --name Gateway --protocol http \
--summary Gateway --username wakari \
--password &#39;&lt;USE PASSWORD SET ABOVE&gt;&#39;
</pre></div>
</div>
<div class="section" id="ensure-proper-permissions">
<h4>1.5.3.1&nbsp;&nbsp;&nbsp;Ensure Proper Permissions<a class="headerlink" href="#ensure-proper-permissions" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chown</span> <span class="n">wakari</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">gateway</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wk</span><span class="o">-</span><span class="n">gateway</span><span class="o">-</span><span class="n">config</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="start-the-gateway">
<h4>1.5.3.2&nbsp;&nbsp;&nbsp;start the gateway<a class="headerlink" href="#start-the-gateway" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">wakari</span><span class="o">-</span><span class="n">gateway</span> <span class="n">start</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> Ignore any errors about missing /lib/lsb/init-functions</p>
</div>
<div class="section" id="verify-the-aen-gateway-has-registered">
<h4>1.5.3.3&nbsp;&nbsp;&nbsp;Verify the AEN Gateway has Registered<a class="headerlink" href="#verify-the-aen-gateway-has-registered" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Login to the AEN Server using Chrome or Firefox browser using the
wakari user.</p>
</li>
<li><p class="first">Click the Admin link in the toolbar</p>
<a class="reference internal image-reference" href="_images/admin-menu.png"><img alt="_images/admin-menu.png" src="_images/admin-menu.png" style="width: 234.4px; height: 170.4px;" /></a>
</li>
<li><p class="first">Click the Datacenters sub­section and then click your datacenter:</p>
<a class="reference internal image-reference" href="_images/datacenter-leftnav.png"><img alt="_images/datacenter-leftnav.png" src="_images/datacenter-leftnav.png" style="width: 682.4px; height: 423.2px;" /></a>
</li>
<li><p class="first">Verify that your datacenter is registered and status is
<code class="docutils literal"><span class="pre">{&quot;status&quot;:</span> <span class="pre">&quot;ok&quot;,</span> <span class="pre">&quot;messages&quot;:</span> <span class="pre">[]}</span></code></p>
<a class="reference internal image-reference" href="_images/datacenter.png"><img alt="_images/datacenter.png" src="_images/datacenter.png" style="width: 680.8px; height: 433.6px;" /></a>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="install-aen-compute">
<h2><a class="toc-backref" href="#id8">1.6&nbsp;&nbsp;&nbsp;Install AEN Compute</a><a class="headerlink" href="#install-aen-compute" title="Permalink to this headline">¶</a></h2>
<p>This is where projects are stored and run. Adding multiple AEN
Compute machines allows one to scale-out horizontally to increase
capacity. Projects can be created on individual compute nodes to spread
the load.</p>
<div class="section" id="id2">
<h3>1.6.1&nbsp;&nbsp;&nbsp;Set Variables and Change Permissions<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">AEN_SERVER</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span> <span class="c1"># Use the real FQDN</span>
<span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="n">wakari</span><span class="o">-*.</span><span class="n">sh</span>                <span class="c1"># Set installer to be executable</span>
</pre></div>
</div>
</div>
<div class="section" id="run-aen-compute-installer">
<h3>1.6.2&nbsp;&nbsp;&nbsp;Run AEN Compute Installer<a class="headerlink" href="#run-aen-compute-installer" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span>sudo ./wakari-compute-0.10.0-Linux-x86_64.sh -w $AEN_SERVER
...
...
PREFIX=/opt/wakari/wakari-compute
Logging to /tmp/wakari_compute.log
Checking server name
...
...
Initial clone of root environment...
Starting Wakari daemons...
installation finished.
Do you wish the installer to prepend the wakari-compute install location
to PATH in your /root/.bashrc ? [yes|no]
[no] &gt;&gt;&gt; yes
</pre></div>
</div>
</div>
<div class="section" id="configure-aen-compute-node">
<h3>1.6.3&nbsp;&nbsp;&nbsp;Configure AEN Compute Node<a class="headerlink" href="#configure-aen-compute-node" title="Permalink to this headline">¶</a></h3>
<p>Once installed, you need to configure the Compute Launcher on AEN Server.</p>
<ol class="arabic">
<li><p class="first">Point your browser at the AEN Server</p>
</li>
<li><p class="first">Login as the wakari user</p>
</li>
<li><p class="first">Click on the Admin link in the top navbar</p>
</li>
<li><p class="first">Click on Enterprise Resources in the left navbar</p>
</li>
<li><p class="first">Click on Add Resource</p>
</li>
<li><p class="first">Select the correct (probably the only) Data Center to associate this
Compute Node with</p>
</li>
<li><p class="first">For URL, enter <strong>http://$AEN_COMPUTE:5002</strong>.</p>
<p><strong>NOTE:</strong> If the Compute Launcher is located on the same box as the
Gateway, we recommend using <strong>http://localhost:5002</strong> for the URL
value.</p>
</li>
<li><p class="first">Add a Name and Description for the compute node</p>
</li>
<li><p class="first">Click the Add Resource button to save the changes.</p>
</li>
</ol>
</div>
<div class="section" id="configure-conda-to-use-local-on-site-anaconda-enterprise-repo">
<h3>1.6.4&nbsp;&nbsp;&nbsp;Configure conda to use local on-site Anaconda Enterprise Repo<a class="headerlink" href="#configure-conda-to-use-local-on-site-anaconda-enterprise-repo" title="Permalink to this headline">¶</a></h3>
<p>This integrates Anaconda Enterprise Notebooks to use a local onsite Anaconda
Enterprise Repository server instead of Anaconda.org.</p>
<div class="section" id="edit-the-condarc-on-the-compute-node">
<h4>1.6.4.1&nbsp;&nbsp;&nbsp;Edit the condarc on the Compute Node<a class="headerlink" href="#edit-the-condarc-on-the-compute-node" title="Permalink to this headline">¶</a></h4>
<p><strong>NOTE:</strong> If there are some channels below that you haven&#8217;t mirrored,
you should remove them from the configuration.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#/opt/wakari/anaconda/.condarc</span>
<span class="n">channels</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">defaults</span>

<span class="n">create_default_packages</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">client</span>
    <span class="o">-</span> <span class="n">python</span>
    <span class="o">-</span> <span class="n">ipython</span><span class="o">-</span><span class="n">we</span>
    <span class="o">-</span> <span class="n">pip</span>

<span class="c1"># Default channels is needed for when users override the system .condarc</span>
<span class="c1"># with ~/.condarc.  This ensures that &quot;defaults&quot; maps to your Anaconda Server and not</span>
<span class="c1"># repo.continuum.io</span>
<span class="n">default_channels</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">wakari</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">channel</span>

<span class="c1"># Note:  You must add the &quot;conda&quot; subdirectory to the end</span>
<span class="n">channel_alias</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-anaconda-client">
<h4>1.6.4.2&nbsp;&nbsp;&nbsp;Configure Anaconda Client<a class="headerlink" href="#configure-anaconda-client" title="Permalink to this headline">¶</a></h4>
<p>Anaconda client lets users work with the Anaconda Repository from the command-line.
Things like the following: search for packages, login, upload packages, etc.  The
command below will set this value globally for all users.</p>
<p>Run the following command filling in the proper value.
Requires <cite>sudo</cite> since config file is written to root file system: <cite>/etc/xdg/binstar/config.yaml</cite>.
This sets the default config for <cite>anaconda-client</cite> for all users on compute node.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">anaconda</span> <span class="n">config</span> <span class="o">--</span><span class="nb">set</span> <span class="n">url</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">api</span> <span class="o">-</span><span class="n">s</span>
</pre></div>
</div>
<p><strong>Congratulations!</strong> You&#8217;ve now successfully installed and configured Anaconda Enterprise Notebook.</p>
</div>
</div>
</div>
<div class="section" id="pam-authentication-optional">
<h2><a class="toc-backref" href="#id9">1.7&nbsp;&nbsp;&nbsp;PAM Authentication (optional)</a><a class="headerlink" href="#pam-authentication-optional" title="Permalink to this headline">¶</a></h2>
<p>This documents the process to configure the preliminary PAM authentication mechanism for AEN 4.0.0.</p>
<ol class="arabic">
<li><p class="first">remove <cite>wk-server</cite> from the current <cite>supervisord</cite> set:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">stop</span> <span class="n">wk</span><span class="o">-</span><span class="n">server</span>
<span class="n">mv</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">supervisord</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">wk</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">conf</span>      \
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">supervisord</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">wk</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">SUSPEND</span> \
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">reload</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">install the new package:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">miniconda</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">conda</span> <span class="n">install</span> \
    <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span> \
    <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.10</span><span class="o">.</span><span class="mi">9</span><span class="o">-</span><span class="mf">0.</span><span class="n">tar</span><span class="o">.</span><span class="n">bz2</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">modify the configuration to utilize the new auth method:</p>
<blockquote>
<div><dl class="docutils">
<dt>::</dt>
<dd><p class="first last">vim /opt/wakari/wakari-server/etc/wakari/wk-server-config.json</p>
</dd>
</dl>
<p>change the entry for the line <cite>&#8220;accounts&#8221;:</cite> to read instead:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;accounts&quot;</span><span class="p">:</span> <span class="s2">&quot;wk_server.plugins.accounts.pam&quot;</span><span class="p">,</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">connect the new <cite>initd</cite> script:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span>
<span class="n">chkconfig</span> <span class="o">--</span><span class="n">add</span> <span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span>
<span class="n">service</span> <span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span> <span class="n">start</span>
<span class="n">service</span> <span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span> <span class="n">status</span>
<span class="n">ps</span> <span class="n">aux</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">wk</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">restart/check the <cite>worker</cite> service is running (and only the <cite>worker</cite>) under the <cite>supervisord</cite> watchdog:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">start</span> <span class="nb">all</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">status</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>