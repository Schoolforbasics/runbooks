<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Anaconda Enterprise Runbooks 4.0-3 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0-3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="None" href="index.html#document-index" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">


<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="continuum-analytics-anaconda-enterprise-deployment-runbooks">
<h1>Continuum Analytics: Anaconda Enterprise Deployment Runbooks<a class="headerlink" href="#continuum-analytics-anaconda-enterprise-deployment-runbooks" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<span id="document-AnacondaRepository"></span><div class="section" id="anaconda-repository-runbook">
<h2>1&nbsp;&nbsp;&nbsp;Anaconda Repository Runbook<a class="headerlink" href="#anaconda-repository-runbook" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Version: 4.0-3 | Aug 05, 2016</li>
</ul>
<p>This following runbook walks through the steps needed to install
Anaconda Repository. The runbook is designed for two audiences: those who have
direct access to the internet for installation and those where such
access is not available or restricted for security reasons. For these
restricted a.k.a. &#8220;Air Gap&#8221; environments, Continuum ships the entire
Anaconda product suite on portable storage medium or as a downloadable
TAR archive. Where necessary, additional instructions for Air Gap
environments are noted. If you have any questions about the
instructions, please contact your sales representative or Priority
Support team, if applicable, for additional assistance.</p>
<img alt="_images/repo.png" src="_images/repo.png" />
<div class="section" id="requirements">
<h3>1.1&nbsp;&nbsp;&nbsp;Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<div class="section" id="hardware-requirements">
<h4>1.1.1&nbsp;&nbsp;&nbsp;Hardware Requirements<a class="headerlink" href="#hardware-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Physical server or VM</li>
<li>CPU: 2 x 64-bit 2 2.8GHz 8.00GT/s CPUs or better</li>
<li>Memory: 32GB RAM (per 50 users)</li>
<li>Storage: Recommended minimum of 300GB; Additional space is
recommended if the repository is will be used to store packages built
by the customer.</li>
</ul>
</div>
<div class="section" id="software-requirements">
<h4>1.1.2&nbsp;&nbsp;&nbsp;Software Requirements<a class="headerlink" href="#software-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>RHEL/CentOS 6.7 (Other operating systems are supported, however this
document assumes RHEL or CentOS 6.7)</li>
<li>MongoDB version 2.6</li>
<li>Anaconda Repository license file - given as part of the welcome packet -
contact your sales representative or support representative if you
cannot find your license.</li>
<li>cron: The anaconda-server user needs to add an entry to cron to start the server on reboot</li>
</ul>
</div>
<div class="section" id="linux-system-accounts-required">
<h4>1.1.3&nbsp;&nbsp;&nbsp;Linux System Accounts Required<a class="headerlink" href="#linux-system-accounts-required" title="Permalink to this headline">¶</a></h4>
<p>Some Linux system accounts (UIDs) are added to the system during installation.
If your organization requires special actions, here is the list of UIDs:</p>
<ul class="simple">
<li>mongod (RHEL) or mongodb (Ubuntu/Debian) - Created by the RPM or deb package</li>
<li>anaconda-server: Created manually during installation</li>
</ul>
</div>
<div class="section" id="security-requirements">
<h4>1.1.4&nbsp;&nbsp;&nbsp;Security Requirements<a class="headerlink" href="#security-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Privileged (root) access or sudo capabilities</li>
<li>Ability to make (optional) iptables modifications</li>
</ul>
<p><strong>NOTE</strong>: SELinux does not have to be disabled for Anaconda Repository
operation</p>
</div>
<div class="section" id="network-requirements">
<h4>1.1.5&nbsp;&nbsp;&nbsp;Network Requirements<a class="headerlink" href="#network-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>TCP Ports<ul>
<li>Inbound TCP 8080 (Anaconda Repository)</li>
<li>Inbound TCP 22 (SSH)</li>
<li>Outbound TCP 443 (to Anaconda Cloud or local Anaconda Repository)</li>
<li>Outbound TCP 25 (SMTP)</li>
<li>Outbound TCP 389/636 (LDAP(s))</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="other-requirements">
<h4>1.1.6&nbsp;&nbsp;&nbsp;Other Requirements<a class="headerlink" href="#other-requirements" title="Permalink to this headline">¶</a></h4>
<p>Assuming the above requirements are met, there are no additional
dependencies necessary for Anaconda Repository.</p>
</div>
<div class="section" id="air-gap-vs-regular-installation">
<h4>1.1.7&nbsp;&nbsp;&nbsp;Air Gap vs. Regular Installation<a class="headerlink" href="#air-gap-vs-regular-installation" title="Permalink to this headline">¶</a></h4>
<p>As stated previously, this document contains installation instructions
for two audiences: those with internet access on the destination
server(s) and those who have no access to internet resources. Many of
the steps below have two sections: <strong>Air Gap Installation</strong> and
<strong>Regular Installation</strong>. Those without internet access should follow
the <strong>Air Gap Installation</strong> instructions and those with internet access
should follow <strong>Regular Installation</strong> instructions.</p>
</div>
<div class="section" id="air-gap-media">
<h4>1.1.8&nbsp;&nbsp;&nbsp;Air Gap Media<a class="headerlink" href="#air-gap-media" title="Permalink to this headline">¶</a></h4>
<p>This document assumes that the Air Gap media is located at /installer on
the server where the software is being installed.</p>
</div>
<div class="section" id="air-gap-media-contents">
<h4>1.1.9&nbsp;&nbsp;&nbsp;Air Gap media contents<a class="headerlink" href="#air-gap-media-contents" title="Permalink to this headline">¶</a></h4>
<div class="highlight-bash"><div class="highlight"><pre><span></span>/installer
___ anaconda-suite
    ___ pkgs
mongodb-org-tools-2.6.8-1.x86_64.rpm
mongodb-org-shell-2.6.8-1.x86_64.rpm
mongodb-org-server-2.6.8-1.x86_64.rpm
mongodb-org-mongos-2.6.8-1.x86_64.rpm
mongodb-org-2.6.8-1.x86_64.rpm
</pre></div>
</div>
</div>
</div>
<div class="section" id="anaconda-repository-installation">
<h3>1.2&nbsp;&nbsp;&nbsp;Anaconda Repository Installation<a class="headerlink" href="#anaconda-repository-installation" title="Permalink to this headline">¶</a></h3>
<p>The following sections detail the steps required to install Anaconda
Repository.</p>
<div class="section" id="install-mongodb">
<h4>1.2.1&nbsp;&nbsp;&nbsp;Install MongoDB<a class="headerlink" href="#install-mongodb" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="download-mongodb-packages">
<h4>1.2.2&nbsp;&nbsp;&nbsp;Download MongoDB packages<a class="headerlink" href="#download-mongodb-packages" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Skip this step.</li>
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>RPM_CDN=&quot;https://820451f3d8380952ce65-4cc6343b423784e82fd202bb87cf87cf.ssl.cf1.rackcdn.com&quot;
curl -O $RPM_CDN/mongodb-org-tools-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-shell-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-server-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-mongos-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-2.6.8-1.x86_64.rpm
</pre></div>
</div>
</div>
<div class="section" id="install-mongodb-packages">
<h4>1.2.3&nbsp;&nbsp;&nbsp;Install MongoDB packages<a class="headerlink" href="#install-mongodb-packages" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>Air Gap Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="o">/</span><span class="n">installer</span><span class="o">/</span><span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">*</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="start-mongodb">
<h4>1.2.4&nbsp;&nbsp;&nbsp;Start mongodb<a class="headerlink" href="#start-mongodb" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">mongod</span> <span class="n">start</span>
</pre></div>
</div>
</div>
<div class="section" id="verify-mongod-is-running">
<h4>1.2.5&nbsp;&nbsp;&nbsp;Verify mongod is running<a class="headerlink" href="#verify-mongod-is-running" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">mongod</span> <span class="n">status</span>
<span class="n">mongod</span> <span class="p">(</span><span class="n">pid</span> <span class="mi">1234</span><span class="p">)</span> <span class="ow">is</span> <span class="n">running</span><span class="o">...</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> Additional mongodb installation information can be found
<a class="reference external" href="https://docs.mongodb.org/manual/tutorial/install-mongodb-on-red-hat/">here</a>.</p>
</div>
</div>
<div class="section" id="configure-anaconda-repository">
<h3>1.3&nbsp;&nbsp;&nbsp;Configure Anaconda Repository<a class="headerlink" href="#configure-anaconda-repository" title="Permalink to this headline">¶</a></h3>
<div class="section" id="create-anaconda-repository-administrator-account">
<h4>1.3.1&nbsp;&nbsp;&nbsp;Create Anaconda Repository administrator account<a class="headerlink" href="#create-anaconda-repository-administrator-account" title="Permalink to this headline">¶</a></h4>
<p>In a terminal window, create a new user account for Anaconda Repository named
&#8220;anaconda-server&#8221;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">useradd</span> <span class="o">-</span><span class="n">m</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> The anaconda-server user is the default for installing Anaconda Repository.
Any username can be used, however the use of the root user is
discouraged.</p>
</div>
<div class="section" id="create-anaconda-repository-directories">
<h4>1.3.2&nbsp;&nbsp;&nbsp;Create Anaconda Repository directories<a class="headerlink" href="#create-anaconda-repository-directories" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">m</span> <span class="mi">0770</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">m</span> <span class="mi">0770</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">m</span> <span class="mi">0770</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">package</span><span class="o">-</span><span class="n">storage</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">m</span> <span class="mi">0770</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span>
</pre></div>
</div>
</div>
<div class="section" id="give-the-anaconda-server-user-ownership-of-directories">
<h4>1.3.3&nbsp;&nbsp;&nbsp;Give the anaconda-server user ownership of directories<a class="headerlink" href="#give-the-anaconda-server-user-ownership-of-directories" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">.</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">.</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">.</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">package</span><span class="o">-</span><span class="n">storage</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">.</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span>
</pre></div>
</div>
</div>
<div class="section" id="switch-to-the-anaconda-repository-administrator-account">
<h4>1.3.4&nbsp;&nbsp;&nbsp;Switch to the Anaconda Repository administrator account<a class="headerlink" href="#switch-to-the-anaconda-repository-administrator-account" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">su</span> <span class="o">-</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="install-miniconda-bootstrap-version">
<h3>1.4&nbsp;&nbsp;&nbsp;Install Miniconda bootstrap version<a class="headerlink" href="#install-miniconda-bootstrap-version" title="Permalink to this headline">¶</a></h3>
<div class="section" id="fetch-the-download-script-using-curl">
<h4>1.4.1&nbsp;&nbsp;&nbsp;Fetch the download script using curl<a class="headerlink" href="#fetch-the-download-script-using-curl" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Skip this step.</li>
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s1">&#39;http://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh&#39;</span> <span class="o">&gt;</span> <span class="n">Miniconda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="run-the-miniconda-sh-installer-script">
<h4>1.4.2&nbsp;&nbsp;&nbsp;Run the Miniconda.sh installer script<a class="headerlink" href="#run-the-miniconda-sh-installer-script" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>Air Gap Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="o">/</span><span class="n">installer</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">suite</span><span class="o">/</span><span class="n">miniconda</span><span class="o">/</span><span class="n">Miniconda</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">Miniconda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="review-and-accept-the-license-terms">
<h4>1.4.3&nbsp;&nbsp;&nbsp;Review and accept the license terms<a class="headerlink" href="#review-and-accept-the-license-terms" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>Welcome to Miniconda (by Continuum Analytics, Inc.)
In order to continue the installation process, please review the license agreement.
Please, press ENTER to continue. Do you approve the license terms? [yes|no] yes
</pre></div>
</div>
</div>
<div class="section" id="accept-the-default-location-or-specify-an-alternative">
<h4>1.4.4&nbsp;&nbsp;&nbsp;Accept the default location or specify an alternative:<a class="headerlink" href="#accept-the-default-location-or-specify-an-alternative" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Miniconda</span> <span class="n">will</span> <span class="n">now</span> <span class="n">be</span> <span class="n">installed</span> <span class="n">into</span> <span class="n">this</span> <span class="n">location</span><span class="p">:</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">miniconda2</span>
<span class="o">-</span><span class="n">Press</span> <span class="n">ENTER</span> <span class="n">to</span> <span class="n">confirm</span> <span class="n">the</span> <span class="n">location</span>
<span class="o">-</span><span class="n">Press</span> <span class="n">CTRL</span><span class="o">-</span><span class="n">C</span> <span class="n">to</span> <span class="n">abort</span> <span class="n">the</span> <span class="n">installation</span>
<span class="o">-</span><span class="n">Or</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">different</span> <span class="n">location</span> <span class="n">below</span>
 <span class="p">[</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">miniconda2</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span><span class="s2">&quot; [Press ENTER]</span>
 <span class="n">PREFIX</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">miniconda2</span>
</pre></div>
</div>
</div>
<div class="section" id="update-the-anaconda-server-user-s-path">
<h4>1.4.5&nbsp;&nbsp;&nbsp;Update the anaconda-server user&#8217;s path<a class="headerlink" href="#update-the-anaconda-server-user-s-path" title="Permalink to this headline">¶</a></h4>
<p>Do you wish the installer to prepend the Miniconda install location to
PATH in your /home/anaconda-server/.bashrc ?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">yes</span><span class="o">|</span><span class="n">no</span><span class="p">]</span> <span class="n">yes</span>
</pre></div>
</div>
</div>
<div class="section" id="for-the-new-path-changes-to-take-effect-source-your-bashrc">
<h4>1.4.6&nbsp;&nbsp;&nbsp;For the new path changes to take effect, “source” your .bashrc<a class="headerlink" href="#for-the-new-path-changes-to-take-effect-source-your-bashrc" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">~/.</span><span class="n">bashrc</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="install-anaconda-repository-enterprise-packages">
<h3>1.5&nbsp;&nbsp;&nbsp;Install Anaconda Repository Enterprise Packages<a class="headerlink" href="#install-anaconda-repository-enterprise-packages" title="Permalink to this headline">¶</a></h3>
<div class="section" id="add-the-binstar-and-anaconda-server-repository-channels-to-conda">
<h4>1.5.1&nbsp;&nbsp;&nbsp;Add the Binstar and Anaconda-Server Repository channels to conda:<a class="headerlink" href="#add-the-binstar-and-anaconda-server-repository-channels-to-conda" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Add the channels from local files.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span>  <span class="n">file</span><span class="p">:</span><span class="o">///</span><span class="n">installer</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">suite</span><span class="o">/</span><span class="n">pkgs</span><span class="o">/</span>
<span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">remove</span> <span class="n">channels</span> <span class="n">defaults</span> <span class="o">--</span><span class="n">force</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>Regular Installation:</strong> Add the channels from Anaconda Cloud.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>export BINSTAR_TOKEN=&lt;your binstar token&gt;
export ANACONDA_TOKEN=&lt;your anaconda-server token&gt;
conda config --add channels https://conda.anaconda.org/t/$BINSTAR_TOKEN/binstar/
conda config --add channels https://conda.anaconda.org/t/$ANACONDA_TOKEN/anaconda-server/
</pre></div>
</div>
<p><strong>Note:</strong> You should have received <strong>two</strong> tokens from Continuum
Support, one for each channel. If you haven&#8217;t, please contact
<a class="reference external" href="mailto:support&#37;&#52;&#48;continuum&#46;io">support<span>&#64;</span>continuum<span>&#46;</span>io</a>. Tokens are not required for Air Gap installs.</p>
</div>
</div>
<div class="section" id="install-the-anaconda-repository-packages-via-conda">
<h3>1.6&nbsp;&nbsp;&nbsp;Install the Anaconda Repository packages via conda:<a class="headerlink" href="#install-the-anaconda-repository-packages-via-conda" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">client</span> <span class="n">binstar</span><span class="o">-</span><span class="n">server</span> <span class="n">binstar</span><span class="o">-</span><span class="n">static</span> <span class="n">cas</span><span class="o">-</span><span class="n">mirror</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-anaconda-repository-server">
<h3>1.7&nbsp;&nbsp;&nbsp;Configure Anaconda Repository Server<a class="headerlink" href="#configure-anaconda-repository-server" title="Permalink to this headline">¶</a></h3>
<div class="section" id="initialize-the-web-server-for-anaconda-repository">
<h4>1.7.1&nbsp;&nbsp;&nbsp;Initialize the web server for Anaconda Repository:<a class="headerlink" href="#initialize-the-web-server-for-anaconda-repository" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">config</span> <span class="o">--</span><span class="n">init</span> <span class="o">--</span><span class="n">config</span><span class="o">-</span><span class="n">file</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
</div>
<div class="section" id="set-the-anaconda-repository-package-storage-location">
<h4>1.7.2&nbsp;&nbsp;&nbsp;Set the Anaconda Repository package storage location:<a class="headerlink" href="#set-the-anaconda-repository-package-storage-location" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">config</span> <span class="o">--</span><span class="nb">set</span> <span class="n">fs_storage_root</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">package</span><span class="o">-</span><span class="n">storage</span> \
                       <span class="o">--</span><span class="n">config</span><span class="o">-</span><span class="n">file</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
</div>
<div class="section" id="create-an-initial-superuser-account-for-anaconda-repository">
<h4>1.7.3&nbsp;&nbsp;&nbsp;Create an initial “superuser” account for Anaconda Repository:<a class="headerlink" href="#create-an-initial-superuser-account-for-anaconda-repository" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">create</span><span class="o">-</span><span class="n">user</span> <span class="o">--</span><span class="n">username</span> <span class="s2">&quot;superuser&quot;</span> \
                            <span class="o">--</span><span class="n">password</span> <span class="s2">&quot;yourpassword&quot;</span> \
                            <span class="o">--</span><span class="n">email</span> <span class="s2">&quot;your@email.com&quot;</span> \
                            <span class="o">--</span><span class="n">superuser</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Note:</th><td class="field-body">to ensure the bash shell does not process any of the
characters in this password, limit the password to lower case letters,
upper case letters and numbers, with no punctuation. After setup the
password can be changed with the web interface.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="initialize-the-anaconda-repository-database">
<h4>1.7.4&nbsp;&nbsp;&nbsp;Initialize the Anaconda Repository database:<a class="headerlink" href="#initialize-the-anaconda-repository-database" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">db</span><span class="o">-</span><span class="n">setup</span> <span class="o">--</span><span class="n">execute</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="set-up-automatic-restart-on-reboot-fail-or-error">
<h3>1.8&nbsp;&nbsp;&nbsp;Set up automatic restart on reboot, fail or error<a class="headerlink" href="#set-up-automatic-restart-on-reboot-fail-or-error" title="Permalink to this headline">¶</a></h3>
<div class="section" id="configure-supervisord">
<h4>1.8.1&nbsp;&nbsp;&nbsp;Configure Supervisord<a class="headerlink" href="#configure-supervisord" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">install</span><span class="o">-</span><span class="n">supervisord</span><span class="o">-</span><span class="n">config</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>This step:</p>
<ul>
<li><p class="first">creates the following entry in the anaconda-server user’s crontab:</p>
<p><code class="docutils literal"><span class="pre">&#64;reboot</span> <span class="pre">/home/anaconda-server/miniconda/bin/supervisord</span></code></p>
</li>
<li><p class="first">generates the <code class="docutils literal"><span class="pre">/home/anaconda-server/miniconda/etc/supervisord.conf</span></code> file</p>
</li>
</ul>
</div>
<div class="section" id="verify-the-server-is-running">
<h4>1.8.2&nbsp;&nbsp;&nbsp;Verify the server is running:<a class="headerlink" href="#verify-the-server-is-running" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">supervisorctl</span> <span class="n">status</span>

<span class="n">binstar</span><span class="o">-</span><span class="n">server</span> <span class="n">RUNNING</span>   <span class="n">pid</span> <span class="mi">10831</span><span class="p">,</span> <span class="n">uptime</span> <span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">05</span>
<span class="n">binstar</span><span class="o">-</span><span class="n">worker</span> <span class="n">RUNNING</span>   <span class="n">pid</span> <span class="mi">2784</span><span class="p">,</span> <span class="n">uptime</span> <span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">04</span>
<span class="o">...</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="install-anaconda-repository-license">
<h4>1.8.3&nbsp;&nbsp;&nbsp;Install Anaconda Repository License<a class="headerlink" href="#install-anaconda-repository-license" title="Permalink to this headline">¶</a></h4>
<p>Visit <strong>http://your.anaconda.server:8080</strong>. Follow the onscreen
instructions and upload your license file. Log in with the superuser
user and password configured above. After submitting, you should see the
login page.</p>
<p><strong>NOTE:</strong> Contact your sales representative or support representative if
you cannot find or have questions about your license.</p>
</div>
<div class="section" id="mirror-installers-for-miniconda">
<h4>1.8.4&nbsp;&nbsp;&nbsp;Mirror Installers for Miniconda<a class="headerlink" href="#mirror-installers-for-miniconda" title="Permalink to this headline">¶</a></h4>
<p>Miniconda installers can be served by Anaconda Repository via the <strong>static</strong>
directory located at
<strong>/home/anaconda-server/miniconda2/lib/python2.7/site-packages/binstar/static/extras</strong>.
This is <strong>required</strong> for Anaconda Cluster integration. To serve up the
latest Miniconda installers for each platform, download them and copy
them to the <strong>extras</strong> directory.</p>
<p>Users will then be able to download installers at a URL that looks like the
following: <a class="reference external" href="http:/">http:/</a>/&lt;your host&gt;:8080/static/extras/Miniconda3-latest-Linux-x86_64.sh</p>
<ul>
<li><p class="first"><strong>Air Gap Installation:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span># miniconda installers
mkdir -p /tmp/extras
pushd /tmp/extras
URL=&quot;file:///installer/anaconda-suite/miniconda/&quot;
versions=&quot;Miniconda3-latest-Linux-x86_64.sh \
Miniconda3-latest-MacOSX-x86_64.sh \
Miniconda3-latest-Windows-x86.exe \
Miniconda3-latest-Windows-x86_64.exe \
Miniconda-latest-Linux-x86_64.sh \
Miniconda-latest-MacOSX-x86_64.sh \
Miniconda-latest-Windows-x86.exe \
Miniconda-latest-Windows-x86_64.exe&quot;

for installer in $versions
 do
  curl -O $URL$installer
done

# Move installers into static directory
popd
cp -a /tmp/extras \
  /home/anaconda-server/miniconda2/lib/python2.7/site-packages/binstar/static
</pre></div>
</div>
</li>
<li><p class="first"><strong>Regular Installation:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span># miniconda installers
mkdir -p /tmp/extras
pushd /tmp/extras
URL=&quot;https://repo.continuum.io/miniconda/&quot;
versions=&quot;Miniconda3-latest-Linux-x86_64.sh \
Miniconda3-latest-MacOSX-x86_64.sh \
Miniconda3-latest-Windows-x86.exe \
Miniconda3-latest-Windows-x86_64.exe \
Miniconda-latest-Linux-x86_64.sh \
Miniconda-latest-MacOSX-x86_64.sh \
Miniconda-latest-Windows-x86.exe \
Miniconda-latest-Windows-x86_64.exe&quot;

for installer in $versions
 do
  curl -O $URL$installer
done

# Move installers into static directory
popd
cp -a /tmp/extras \
     /home/anaconda-server/miniconda2/lib/python2.7/site-packages/binstar/static
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="mirror-anaconda-repository">
<h4>1.8.5&nbsp;&nbsp;&nbsp;Mirror Anaconda Repository<a class="headerlink" href="#mirror-anaconda-repository" title="Permalink to this headline">¶</a></h4>
<p>Now that Anaconda Repository is installed, we want to mirror packages into our
local repository. If mirroring from Anaconda Cloud, the process will
take hours or longer, depending on the available internet bandwidth. Use
the <code class="docutils literal"><span class="pre">anaconda-server-sync-conda</span></code> command to mirror all Anaconda
packages locally under the &#8220;anaconda&#8221; user account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Note:</th><td class="field-body">Ignore any license warnings. Additional mirror filtering/whitelisting/blacklisting options can be found <a class="reference external" href="https://docs.continuum.io/anaconda-repository/mirrors-sync-configuration">here</a>.</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first"><strong>Air Gap Installation:</strong> Since we&#8217;re mirroring from a local
filesystem, some additional configuration is necessary.</p>
<p><strong>1.</strong> Create a mirror config file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">conda</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>Add the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">file</span><span class="p">:</span><span class="o">///</span><span class="n">installer</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">suite</span><span class="o">/</span><span class="n">pkgs</span>
</pre></div>
</div>
<p><strong>2.</strong> Mirror the Anaconda packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">config</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">conda</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Regular Installation:</strong> Mirror from Anaconda Cloud.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span>
</pre></div>
</div>
</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Note:</th><td class="field-body">Depending on the type of installation, this process may take hours.</td>
</tr>
</tbody>
</table>
<p>To verify the local Anaconda Repository repo has been populated, visit
<strong>http://your.anaconda.server:8080/anaconda</strong> in a browser.</p>
</div>
<div class="section" id="optional-mirror-the-r-channel">
<h4>1.8.6&nbsp;&nbsp;&nbsp;Optional: Mirror the R channel<a class="headerlink" href="#optional-mirror-the-r-channel" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first"><strong>Air Gap Installation:</strong></p>
<p><strong>1.</strong> Create a mirror config file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">chanel</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p><strong>2.</strong> Add the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">file</span><span class="p">:</span><span class="o">///</span><span class="n">installer</span><span class="o">/</span><span class="n">r</span><span class="o">/</span><span class="n">pkgs</span>
</pre></div>
</div>
<p><strong>3.</strong> Mirror the Anaconda Cluster Management packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">config</span> \
    <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">channel</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">account</span><span class="o">=</span><span class="n">r</span><span class="o">-</span><span class="n">channel</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Regular Installation:</strong></p>
<p><strong>1.</strong> Create a mirror config file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">channel</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p><strong>2.</strong> Add the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">r</span>
</pre></div>
</div>
<p><strong>3.</strong> Mirror the R packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">config</span> \
    <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">channel</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">account</span><span class="o">=</span><span class="n">r</span><span class="o">-</span><span class="n">channel</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="optional-mirror-the-anaconda-enterprise-notebooks-channel">
<h4>1.8.7&nbsp;&nbsp;&nbsp;Optional: Mirror the Anaconda Enterprise Notebooks Channel<a class="headerlink" href="#optional-mirror-the-anaconda-enterprise-notebooks-channel" title="Permalink to this headline">¶</a></h4>
<p>If the local Anaconda Repository will be used by Anaconda Enterprise Notebooks
the recommended method is to mirror using the “wakari” user.
To mirror the Anaconda Enterprise Notebooks repo, create the mirror config
YAML file below:</p>
<ul>
<li><p class="first"><strong>Air Gap Installation:</strong></p>
<p><strong>1.</strong> Create a mirror config file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">wakari</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p><strong>2.</strong> Add the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">file</span><span class="p">:</span><span class="o">///</span><span class="n">installer</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">pkgs</span>
  <span class="o">-</span> <span class="n">file</span><span class="p">:</span><span class="o">///</span><span class="n">installer</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">nb</span><span class="o">-</span><span class="n">extensions</span><span class="o">/</span><span class="n">pkgs</span>
</pre></div>
</div>
<p><strong>3.</strong> Mirror the Anaconda Enteprise Notebooks packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">config</span> \
    <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">wakari</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">account</span><span class="o">=</span><span class="n">wakari</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Regular Installation:</strong></p>
<p><strong>1.</strong> Create a mirror config file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">wakari</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p><strong>2.</strong> Add the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">t</span><span class="o">/&lt;</span><span class="n">TOKEN</span><span class="o">&gt;/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">nb</span><span class="o">-</span><span class="n">extensions</span>
  <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">wakari</span>
</pre></div>
</div>
<p><strong>3.</strong> Mirror the Anaconda Enterprise Notebooks packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">config</span> \
  <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">wakari</span><span class="o">.</span><span class="n">yaml</span> <span class="o">--</span><span class="n">account</span><span class="o">=</span><span class="n">wakari</span>
</pre></div>
</div>
</li>
</ul>
<p>Where <strong>“TOKEN”</strong> is the Anaconda NB Extensions token you should
have received from Continuum Support.</p>
</div>
<div class="section" id="optional-mirror-the-anaconda-cluster-management-channel">
<h4>1.8.8&nbsp;&nbsp;&nbsp;Optional: Mirror the Anaconda Cluster Management channel<a class="headerlink" href="#optional-mirror-the-anaconda-cluster-management-channel" title="Permalink to this headline">¶</a></h4>
<p>If the local Anaconda Repository will be used by Anaconda Cluster nodes (head
or compute), the recommended method is to mirror using an
“anaconda-cluster” user. To mirror the Anaconda Cluster Management repo,
create the mirror config YAML file below:</p>
<ul>
<li><p class="first"><strong>Air Gap Installation:</strong></p>
<p><strong>1.</strong> Create a mirror config file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p><strong>2.</strong> Add the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">file</span><span class="p">:</span><span class="o">///</span><span class="n">installer</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span><span class="o">/</span><span class="n">pkgs</span>
</pre></div>
</div>
<p><strong>3.</strong> Mirror the Anaconda Cluster Management packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">config</span> \
   <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">yaml</span> \
   <span class="o">--</span><span class="n">account</span><span class="o">=</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Regular Installation:</strong></p>
<p><strong>1.</strong> Create a mirror config file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p><strong>2.</strong> Add the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">t</span><span class="o">/</span><span class="n">L8pxtQupjz01</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
</pre></div>
</div>
<p><strong>3.</strong> Mirror the Anaconda Cluster Management packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">sync</span><span class="o">-</span><span class="n">conda</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">config</span> \
   <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">mirrors</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">yaml</span> \
   <span class="o">--</span><span class="n">account</span><span class="o">=</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="optional-adjust-iptables-to-accept-requests-on-port-80">
<h4>1.8.9&nbsp;&nbsp;&nbsp;Optional: Adjust iptables to accept requests on port 80<a class="headerlink" href="#optional-adjust-iptables-to-accept-requests-on-port-80" title="Permalink to this headline">¶</a></h4>
<p>The easiest way to enable clients to access an Anaconda Repository on standard
ports is to configure the server to redirect traffic received on
standard HTTP port 80 to the standard Anaconda Repository HTTP port 8080.</p>
<p><strong>NOTE:</strong> These commands assume the default state of iptables on CentOS
6.7 which is “on” and allowing inbound SSH access on port 22. Take
caution; mistakes with iptables rules can render a remote machine
inaccessible.</p>
<p><strong>Allow inbound access to tcp port 80:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">i</span> <span class="n">eth0</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="mi">80</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span> \
              <span class="o">-</span><span class="n">m</span> <span class="n">comment</span> <span class="o">--</span><span class="n">comment</span> <span class="s2">&quot;# Anaconda Repository #&quot;</span>
</pre></div>
</div>
<p><strong>Allow inbound access to tcp port 8080:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">i</span> <span class="n">eth0</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="mi">8080</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span> \
              <span class="o">-</span><span class="n">m</span> <span class="n">comment</span> <span class="o">--</span><span class="n">comment</span> <span class="s2">&quot;# Anaconda Repository #&quot;</span>
</pre></div>
</div>
<p><strong>Redirect inbound requests to port 80 to port 8080:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">PREROUTING</span> <span class="o">-</span><span class="n">t</span> <span class="n">nat</span> <span class="o">-</span><span class="n">i</span> <span class="n">eth0</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">--</span><span class="n">dport</span> <span class="mi">80</span> \
              <span class="o">-</span><span class="n">j</span> <span class="n">REDIRECT</span> <span class="o">--</span><span class="n">to</span><span class="o">-</span><span class="n">port</span> <span class="mi">8080</span> \
              <span class="o">-</span><span class="n">m</span> <span class="n">comment</span> <span class="o">--</span><span class="n">comment</span> <span class="s2">&quot;# Anaconda Repository #&quot;</span>
</pre></div>
</div>
<p><strong>Display the current iptables rules:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">n</span>
<span class="n">Chain</span> <span class="n">INPUT</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>     <span class="n">destination</span>
<span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="mi">8080</span> <span class="c1"># Anaconda Repository #</span>
<span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="mi">80</span> <span class="c1"># Anaconda Repository #</span>
<span class="n">ACCEPT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="n">state</span> <span class="n">RELATED</span><span class="p">,</span><span class="n">ESTABLISHED</span>
<span class="n">ACCEPT</span>     <span class="n">icmp</span> <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>
<span class="n">ACCEPT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>
<span class="n">ACCEPT</span>     <span class="n">tcp</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="n">state</span> <span class="n">NEW</span> <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="mi">22</span>
<span class="n">REJECT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>

<span class="n">Chain</span> <span class="n">FORWARD</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>     <span class="n">destination</span>
<span class="n">REJECT</span>     <span class="nb">all</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="n">reject</span><span class="o">-</span><span class="k">with</span> <span class="n">icmp</span><span class="o">-</span><span class="n">host</span><span class="o">-</span><span class="n">prohibited</span>

<span class="n">Chain</span> <span class="n">OUTPUT</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>     <span class="n">destination</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> the PREROUTING (nat) iptables chain is not displayed by
default; to show it, use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">t</span> <span class="n">nat</span>
<span class="n">Chain</span> <span class="n">PREROUTING</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>        <span class="n">destination</span>
<span class="n">REDIRECT</span>   <span class="n">tcp</span>  <span class="o">--</span>  <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>     <span class="n">tcp</span> <span class="n">dpt</span><span class="p">:</span><span class="mi">80</span> <span class="c1"># Anaconda Repository # redir ports 8080</span>

<span class="n">Chain</span> <span class="n">POSTROUTING</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>        <span class="n">destination</span>

<span class="n">Chain</span> <span class="n">OUTPUT</span> <span class="p">(</span><span class="n">policy</span> <span class="n">ACCEPT</span><span class="p">)</span>
<span class="n">target</span>     <span class="n">prot</span> <span class="n">opt</span> <span class="n">source</span>        <span class="n">destination</span>
</pre></div>
</div>
<p>Write the running iptables configuration to <strong>/etc/sysconfig/iptables:</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">iptables</span> <span class="n">save</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-AnacondaEnterpriseNotebooks"></span><div class="section" id="anaconda-enterprise-notebook-runbook">
<h2>1&nbsp;&nbsp;&nbsp;Anaconda Enterprise Notebook Runbook<a class="headerlink" href="#anaconda-enterprise-notebook-runbook" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Version: 4.0-3 | Aug 05, 2016</li>
</ul>
<p>Anaconda Enterprise Notebook (AEN) is a Python data analysis environment from
Continuum Analytics. Accessed through a browser, Anaconda Enterprise
Notebooks is a ready-to-use, powerful, fully-configured Python analytics
environment. We believe that programmers, scientists, and analysts
should spend their time analyzing data, not working to set up a system.
Data should be shareable, and analysis should be repeatable.
Reproducibility should extend beyond just code to include the runtime
environment, configuration, and input data.</p>
<p>Anaconda Enterprise Notebooks makes it easy to start your analysis
immediately.</p>
<p>This runbook walks through the steps needed to install a basic Anaconda
Enterprise Notebook system comprised of the front-end server, gateway,
and two compute machines. The runbook is designed for two audiences:
those who have direct access to the internet for installation and those
where such access is not available or restricted for security reasons.
For these restricted a.k.a. &#8220;Air Gap&#8221; environments, Continuum ships the
entire Anaconda product suite on portable storage medium or as a
downloadable TAR archive. Where necessary, additional instructions for
Air Gap environments are noted. If you have any questions about the
instructions, please contact your sales representative or Priority
Support team, if applicable, for additional assistance.</p>
<p><strong>AEN Server:</strong> The administrative front-end to the system. This is
where users login to the system, where user accounts are stored, and
where admins can manage the system.</p>
<p><strong>AEN Gateway:</strong> The gateway is a reverse proxy that authenticates
users and automatically directs them to the proper AEN Compute
machine for their project. Users will not notice this component as it
automatically routes them. One could put a gateway in each datacenter in
a tiered scale-out fashion.</p>
<p><strong>AEN Compute nodes:</strong> This is where projects are stored and run.
AEN Compute machines only need to be reachable by the AEN Gateway,
so they can be completely isolated by a firewall.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/wakari.png"><img alt="_images/wakari.png" class="align-center" src="_images/wakari.png" style="width: 816.0px; height: 1056.0px;" /></a>
</div></blockquote>
<div class="section" id="requirements">
<h3>1.1&nbsp;&nbsp;&nbsp;Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<div class="section" id="hardware-recommendations">
<h4>1.1.1&nbsp;&nbsp;&nbsp;Hardware Recommendations<a class="headerlink" href="#hardware-recommendations" title="Permalink to this headline">¶</a></h4>
<p><strong>AEN Server</strong></p>
<ul class="simple">
<li>2+GB RAM</li>
<li>2+CPU cores</li>
<li>20GB storage</li>
</ul>
<p><strong>AEN Gateway</strong></p>
<ul class="simple">
<li>2 GB RAM</li>
<li>2 CPU cores</li>
</ul>
<p><strong>AEN Compute</strong> (N-machines)</p>
<p>Configure to meet the needs of the projects. At least:</p>
<ul class="simple">
<li>2GB RAM</li>
<li>2 CPU cores</li>
</ul>
</div>
<div class="section" id="os-requirements">
<h4>1.1.2&nbsp;&nbsp;&nbsp;OS Requirements<a class="headerlink" href="#os-requirements" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">RHEL/CentOS 6.7 on all nodes (Other operating systems are supported,
however this document assumes RHEL or CentOS 6.7)</p>
</li>
<li><p class="first"><strong>/opt/wakari:</strong> Ability to install here and at least 5GB of storage.</p>
</li>
<li><p class="first"><strong>/projects:</strong> Size depends on number and size of projects. At least
20GB of storage.</p>
<p><strong>NOTE:</strong> This directory needs the filesystem mounted with Posix ACL
support (Posix.1e). Check with <code class="docutils literal"><span class="pre">mount</span></code> and
<code class="docutils literal"><span class="pre">tune2fs</span> <span class="pre">-l</span> <span class="pre">/path/to/filesystem</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">options</span></code></p>
</li>
</ul>
</div>
<div class="section" id="software-prerequisites">
<h4>1.1.3&nbsp;&nbsp;&nbsp;Software Prerequisites<a class="headerlink" href="#software-prerequisites" title="Permalink to this headline">¶</a></h4>
<p><strong>AEN Server</strong></p>
<ul class="simple">
<li>Mongo Version: &gt;= 2.6.8 and &lt; 3.0</li>
<li>Nginx version: &gt;= 1.4.0</li>
<li>ElasticSearch</li>
<li>Oracle JRE 8</li>
</ul>
<p><strong>NOTE:</strong> For Air Gap installations, Oracle JRE must already be
installed</p>
<p><strong>AEN Compute</strong></p>
<ul class="simple">
<li>git</li>
</ul>
</div>
<div class="section" id="linux-system-accounts-required">
<h4>1.1.4&nbsp;&nbsp;&nbsp;Linux System Accounts Required<a class="headerlink" href="#linux-system-accounts-required" title="Permalink to this headline">¶</a></h4>
<p>Some Linux system accounts (UIDs) are added to the system during installation.
If your organization requires special actions, here is the list of UIDs:</p>
<ul class="simple">
<li>mongod (RHEL) or mongodb (Ubuntu/Debian): Created by the RPM or deb package</li>
<li>elasticsearch: created by RPM or deb package</li>
<li>nginx: created by RPM or deb package</li>
<li>wakari: Created during installation of Anaconda Enterprise Notebooks</li>
</ul>
</div>
<div class="section" id="security-requirements">
<h4>1.1.5&nbsp;&nbsp;&nbsp;Security Requirements<a class="headerlink" href="#security-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>root or sudo access</li>
<li>SELinux in Permissive or Disabled mode - check with <code class="docutils literal"><span class="pre">getenforce</span></code></li>
</ul>
</div>
<div class="section" id="network-requirements">
<h4>1.1.6&nbsp;&nbsp;&nbsp;Network Requirements<a class="headerlink" href="#network-requirements" title="Permalink to this headline">¶</a></h4>
<p><strong>TCP Ports</strong></p>
<ul class="simple">
<li>Server: 80</li>
<li>Gateway: 8088</li>
<li>Compute: 5002</li>
</ul>
</div>
<div class="section" id="other-requirements">
<h4>1.1.7&nbsp;&nbsp;&nbsp;Other Requirements<a class="headerlink" href="#other-requirements" title="Permalink to this headline">¶</a></h4>
<p>Assuming the above requirements are met, there are no additional
dependencies necessary for AEN.</p>
</div>
<div class="section" id="air-gap-vs-regular-installation">
<h4>1.1.8&nbsp;&nbsp;&nbsp;Air Gap vs. Regular Installation<a class="headerlink" href="#air-gap-vs-regular-installation" title="Permalink to this headline">¶</a></h4>
<p>As stated previously, this document contains installation instructions
for two audiences: those with internet access on the destination
server(s) and those who have no access to internet resources. Many of
the steps below have two sections: <strong>Air Gap Installation</strong> and
<strong>Regular Installation</strong>. Those without internet access should follow
the <strong>Air Gap Installation</strong> instructions and those with internet access
should follow <strong>Regular Installation</strong> instructions.</p>
</div>
<div class="section" id="air-gap-media">
<h4>1.1.9&nbsp;&nbsp;&nbsp;Air Gap Media<a class="headerlink" href="#air-gap-media" title="Permalink to this headline">¶</a></h4>
<p>This document assumes that the Air Gap media is located at /installer on
the server where the software is being installed.</p>
<p>Air Gap media contents:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">installer</span>
<span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="mf">2.6</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">shell</span><span class="o">-</span><span class="mf">2.6</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">2.6</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">mongos</span><span class="o">-</span><span class="mf">2.6</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="mf">2.6</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="mf">1.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">wakari</span><span class="o">-</span><span class="n">compute</span><span class="o">-</span><span class="mf">0.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">0.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">wakari</span><span class="o">-</span><span class="n">gateway</span><span class="o">-</span><span class="mf">0.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">nginx</span><span class="o">-</span><span class="mf">1.6</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="n">el6</span><span class="o">.</span><span class="n">ngx</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">elasticsearch</span><span class="o">-</span><span class="mf">1.7</span><span class="o">.</span><span class="mf">2.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">jre</span><span class="o">-</span><span class="mi">8</span><span class="n">u65</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">.</span><span class="n">rpm</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="download-the-installers">
<h3>1.2&nbsp;&nbsp;&nbsp;Download the Installers<a class="headerlink" href="#download-the-installers" title="Permalink to this headline">¶</a></h3>
<p>Download the installers and copy them to the corresponding servers. The
Publisher should be installed on the AEN Server machine.</p>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Copy installers from the Air Gap media</li>
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>RPM_CDN=&quot;https://820451f3d8380952ce65-4cc6343b423784e82fd202bb87cf87cf.ssl.cf1.rackcdn.com&quot;
curl -O $RPM_CDN/wakari-server-0.10.0-Linux-x86_64.sh
curl -O $RPM_CDN/wakari-gateway-0.10.0-Linux-x86_64.sh
curl -O $RPM_CDN/wakari-compute-0.10.0-Linux-x86_64.sh
</pre></div>
</div>
</div>
<div class="section" id="gather-ip-addresses-or-fqdns">
<h3>1.3&nbsp;&nbsp;&nbsp;Gather IP addresses or FQDNs<a class="headerlink" href="#gather-ip-addresses-or-fqdns" title="Permalink to this headline">¶</a></h3>
<p>AEN is very sensitive to the IP address or domain name used to
connect to the Server and Gateway components. If users will be using the
domain name, you should install thecomponents using the domain name
instead of the IP addresses. The authentication systemrequires the
proper hostnames when authenticating users between the services.</p>
<p>Fill in the domain names or IP addresses of the components below and
record the auto­generated wakari password in the box below after
installing the AEN Server component.</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Component     | Name or IP address</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="2">AEN Server    |</td>
</tr>
<tr class="row-odd"><td colspan="2">AEN Gateway   |</td>
</tr>
<tr class="row-even"><td colspan="2">AEN Compute   |</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="install-aen-server">
<h3>1.4&nbsp;&nbsp;&nbsp;Install AEN Server<a class="headerlink" href="#install-aen-server" title="Permalink to this headline">¶</a></h3>
<p>The AEN server is the administrative front­end to the system. This is
where users login to the system, where user accounts are stored, and
where admins can manage the system.</p>
<div class="section" id="aen-server-preparation-prerequisites">
<h4>1.4.1&nbsp;&nbsp;&nbsp;AEN Server Preparation ­Prerequisites<a class="headerlink" href="#aen-server-preparation-prerequisites" title="Permalink to this headline">¶</a></h4>
<div class="section" id="download-prerequisite-rpms">
<h5>1.4.1.1&nbsp;&nbsp;&nbsp;Download Prerequisite RPMs<a class="headerlink" href="#download-prerequisite-rpms" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Copy RPMs from the Air Gap media</li>
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>RPM_CDN=&quot;https://820451f3d8380952ce65-4cc6343b423784e82fd202bb87cf87cf.ssl.cf1.rackcdn.com&quot;
curl -O $RPM_CDN/nginx-1.6.2-1.el6.ngx.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-tools-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-shell-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-server-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-mongos-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/mongodb-org-2.6.8-1.x86_64.rpm
curl -O $RPM_CDN/elasticsearch-1.7.2.noarch.rpm
curl -O $RPM_CDN/jre-8u65-linux-x64.rpm
</pre></div>
</div>
</div>
<div class="section" id="install-prerequisite-rpms">
<h5>1.4.1.2&nbsp;&nbsp;&nbsp;Install Prerequisite RPMs<a class="headerlink" href="#install-prerequisite-rpms" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="o">*.</span><span class="n">rpm</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">mongod</span> <span class="n">start</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">elasticsearch</span> <span class="n">stop</span>
<span class="n">sudo</span> <span class="n">chkconfig</span> <span class="o">--</span><span class="n">add</span> <span class="n">elasticsearch</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-the-aen-server-installer">
<h4>1.4.2&nbsp;&nbsp;&nbsp;Run the AEN Server Installer<a class="headerlink" href="#run-the-aen-server-installer" title="Permalink to this headline">¶</a></h4>
<div class="section" id="set-variables-and-change-permissions">
<h5>1.4.2.1&nbsp;&nbsp;&nbsp;Set Variables and Change Permissions<a class="headerlink" href="#set-variables-and-change-permissions" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">AEN_SERVER</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span> <span class="c1"># Use the real FQDN</span>
<span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="n">wakari</span><span class="o">-*.</span><span class="n">sh</span>                <span class="c1"># Set installer to be executable</span>
</pre></div>
</div>
</div>
<div class="section" id="run-aen-server-installer">
<h5>1.4.2.2&nbsp;&nbsp;&nbsp;Run AEN Server Installer<a class="headerlink" href="#run-aen-server-installer" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span>sudo ./wakari-server-0.10.0-Linux-x86_64.sh -w $AEN_SERVER
&lt;license text&gt;
...
...

PREFIX=/opt/wakari/wakari-server
Logging to /tmp/wakari_server.log
Checking server name
Ready for pre-install steps
Installing miniconda
...
...
Checking server name
Loading config from /opt/wakari/wakari-server/etc/wakari/config.json
Loading config from /opt/wakari/wakari-server/etc/wakari/wk-server-config.json


===================================

Created password &#39;&lt;RANDOM_PASSWORD&gt;&#39; for user &#39;wakari&#39;

===================================


Starting Wakari daemons...
installation finished.
</pre></div>
</div>
<p>After successfully completing the installation script, the installer
will create the administrator account (wakari user) and assign it a
password:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Created</span> <span class="n">password</span> <span class="s1">&#39;&lt;RANDOM_PASSWORD&gt;&#39;</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;wakari&#39;</span>
</pre></div>
</div>
<p><strong>Record this password.</strong> It will be needed in the following steps. It
is also available in the installation log file found at
<code class="docutils literal"><span class="pre">/tmp/wakari_server.log</span></code></p>
</div>
<div class="section" id="start-elasticsearch">
<h5>1.4.2.3&nbsp;&nbsp;&nbsp;Start ElasticSearch<a class="headerlink" href="#start-elasticsearch" title="Permalink to this headline">¶</a></h5>
<p>Start elasticsearch to read the new config file</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">elasticsearch</span> <span class="n">start</span>
</pre></div>
</div>
</div>
<div class="section" id="test-the-aen-server-install">
<h5>1.4.2.4&nbsp;&nbsp;&nbsp;Test the AEN Server install<a class="headerlink" href="#test-the-aen-server-install" title="Permalink to this headline">¶</a></h5>
<p>Visit <a class="reference external" href="http://$AEN_SERVER">http://$AEN_SERVER</a>. You should be shown the <strong>&#8220;license
expired&#8221;</strong> page.</p>
</div>
<div class="section" id="update-the-license">
<h5>1.4.2.5&nbsp;&nbsp;&nbsp;Update the License<a class="headerlink" href="#update-the-license" title="Permalink to this headline">¶</a></h5>
<p>From the <strong>&#8220;license expired&#8221;</strong> page, follow the onscreen instructions to
upload your license file. After submitting, you should see the login
page.</p>
</div>
</div>
</div>
<div class="section" id="install-aen-gateway">
<h3>1.5&nbsp;&nbsp;&nbsp;Install AEN Gateway<a class="headerlink" href="#install-aen-gateway" title="Permalink to this headline">¶</a></h3>
<p>The gateway is a reverse proxy that authenticates users and
automatically directs them to the proper AEN Compute machine for
their project. Users will not notice this component as it automatically
routes them.</p>
<div class="section" id="id1">
<h4>1.5.1&nbsp;&nbsp;&nbsp;Set Variables and Change Permissions<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">AEN_SERVER</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span> <span class="c1"># Use the real FQDN</span>
<span class="n">export</span> <span class="n">AEN_GATEWAY_PORT</span><span class="o">=</span><span class="mi">8088</span>
<span class="n">export</span> <span class="n">AEN_GATEWAY</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span>  <span class="c1"># will be needed shortly</span>
<span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="n">wakari</span><span class="o">-*.</span><span class="n">sh</span>                <span class="c1"># Set installer to be executable</span>
</pre></div>
</div>
</div>
<div class="section" id="run-wakari-gateway-installer">
<h4>1.5.2&nbsp;&nbsp;&nbsp;Run Wakari Gateway Installer<a class="headerlink" href="#run-wakari-gateway-installer" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>sudo ./wakari-gateway-0.10.0-Linux-x86_64.sh -w $AEN_SERVER
&lt;license text&gt;
...
...

PREFIX=/opt/wakari/wakari-gateway
Logging to /tmp/wakari_gateway.log
...
...
Checking server name
Please restart the Gateway after running the following command
to connect this Gateway to the AEN Server
...
</pre></div>
</div>
<p><strong>NOTE:</strong> replace <strong>password</strong> with the password of the wakari user that
was generated during server installation.</p>
</div>
<div class="section" id="register-the-aen-gateway">
<h4>1.5.3&nbsp;&nbsp;&nbsp;Register the AEN Gateway<a class="headerlink" href="#register-the-aen-gateway" title="Permalink to this headline">¶</a></h4>
<p>The AEN Gateway needs to register with the AEN Server. This needs
to be authenticated, so the wakari user’s credentials created during the
AEN Server install need to be used. <strong>This needs to be run as sudo or root</strong>
to write the configuration file:
<code class="docutils literal"><span class="pre">/opt/wakari/wakari-gateway/etc/wakari/wk-gateway-config.json</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span>/opt/wakari/wakari-gateway/bin/wk-gateway-configure \
--server http://$AEN_SERVER --host $AEN_GATEWAY \
--port $AEN_GATEWAY_PORT --name Gateway --protocol http \
--summary Gateway --username wakari \
--password &#39;&lt;USE PASSWORD SET ABOVE&gt;&#39;
</pre></div>
</div>
<div class="section" id="ensure-proper-permissions">
<h5>1.5.3.1&nbsp;&nbsp;&nbsp;Ensure Proper Permissions<a class="headerlink" href="#ensure-proper-permissions" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chown</span> <span class="n">wakari</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">gateway</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wk</span><span class="o">-</span><span class="n">gateway</span><span class="o">-</span><span class="n">config</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="start-the-gateway">
<h5>1.5.3.2&nbsp;&nbsp;&nbsp;start the gateway<a class="headerlink" href="#start-the-gateway" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">wakari</span><span class="o">-</span><span class="n">gateway</span> <span class="n">start</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> Ignore any errors about missing /lib/lsb/init-functions</p>
</div>
<div class="section" id="verify-the-aen-gateway-has-registered">
<h5>1.5.3.3&nbsp;&nbsp;&nbsp;Verify the AEN Gateway has Registered<a class="headerlink" href="#verify-the-aen-gateway-has-registered" title="Permalink to this headline">¶</a></h5>
<ol class="arabic">
<li><p class="first">Login to the AEN Server using Chrome or Firefox browser using the
wakari user.</p>
</li>
<li><p class="first">Click the Admin link in the toolbar</p>
<a class="reference internal image-reference" href="_images/admin-menu.png"><img alt="_images/admin-menu.png" src="_images/admin-menu.png" style="width: 234.4px; height: 170.4px;" /></a>
</li>
<li><p class="first">Click the Datacenters sub­section and then click your datacenter:</p>
<a class="reference internal image-reference" href="_images/datacenter-leftnav.png"><img alt="_images/datacenter-leftnav.png" src="_images/datacenter-leftnav.png" style="width: 682.4px; height: 423.2px;" /></a>
</li>
<li><p class="first">Verify that your datacenter is registered and status is
<code class="docutils literal"><span class="pre">{&quot;status&quot;:</span> <span class="pre">&quot;ok&quot;,</span> <span class="pre">&quot;messages&quot;:</span> <span class="pre">[]}</span></code></p>
<a class="reference internal image-reference" href="_images/datacenter.png"><img alt="_images/datacenter.png" src="_images/datacenter.png" style="width: 680.8px; height: 433.6px;" /></a>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="install-aen-compute">
<h3>1.6&nbsp;&nbsp;&nbsp;Install AEN Compute<a class="headerlink" href="#install-aen-compute" title="Permalink to this headline">¶</a></h3>
<p>This is where projects are stored and run. Adding multiple AEN
Compute machines allows one to scale-out horizontally to increase
capacity. Projects can be created on individual compute nodes to spread
the load.</p>
<div class="section" id="id2">
<h4>1.6.1&nbsp;&nbsp;&nbsp;Set Variables and Change Permissions<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">AEN_SERVER</span><span class="o">=&lt;</span><span class="n">FQDN</span> <span class="n">HOSTNAME</span><span class="o">&gt;</span> <span class="c1"># Use the real FQDN</span>
<span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="n">wakari</span><span class="o">-*.</span><span class="n">sh</span>                <span class="c1"># Set installer to be executable</span>
</pre></div>
</div>
</div>
<div class="section" id="run-aen-compute-installer">
<h4>1.6.2&nbsp;&nbsp;&nbsp;Run AEN Compute Installer<a class="headerlink" href="#run-aen-compute-installer" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>sudo ./wakari-compute-0.10.0-Linux-x86_64.sh -w $AEN_SERVER
...
...
PREFIX=/opt/wakari/wakari-compute
Logging to /tmp/wakari_compute.log
Checking server name
...
...
Initial clone of root environment...
Starting Wakari daemons...
installation finished.
Do you wish the installer to prepend the wakari-compute install location
to PATH in your /root/.bashrc ? [yes|no]
[no] &gt;&gt;&gt; yes
</pre></div>
</div>
</div>
<div class="section" id="configure-aen-compute-node">
<h4>1.6.3&nbsp;&nbsp;&nbsp;Configure AEN Compute Node<a class="headerlink" href="#configure-aen-compute-node" title="Permalink to this headline">¶</a></h4>
<p>Once installed, you need to configure the Compute Launcher on AEN Server.</p>
<ol class="arabic">
<li><p class="first">Point your browser at the AEN Server</p>
</li>
<li><p class="first">Login as the wakari user</p>
</li>
<li><p class="first">Click on the Admin link in the top navbar</p>
</li>
<li><p class="first">Click on Enterprise Resources in the left navbar</p>
</li>
<li><p class="first">Click on Add Resource</p>
</li>
<li><p class="first">Select the correct (probably the only) Data Center to associate this
Compute Node with</p>
</li>
<li><p class="first">For URL, enter <strong>http://$AEN_COMPUTE:5002</strong>.</p>
<p><strong>NOTE:</strong> If the Compute Launcher is located on the same box as the
Gateway, we recommend using <strong>http://localhost:5002</strong> for the URL
value.</p>
</li>
<li><p class="first">Add a Name and Description for the compute node</p>
</li>
<li><p class="first">Click the Add Resource button to save the changes.</p>
</li>
</ol>
</div>
<div class="section" id="configure-conda-to-use-local-on-site-anaconda-enterprise-repo">
<h4>1.6.4&nbsp;&nbsp;&nbsp;Configure conda to use local on-site Anaconda Enterprise Repo<a class="headerlink" href="#configure-conda-to-use-local-on-site-anaconda-enterprise-repo" title="Permalink to this headline">¶</a></h4>
<p>This integrates Anaconda Enterprise Notebooks to use a local onsite Anaconda
Enterprise Repository server instead of Anaconda.org.</p>
<div class="section" id="edit-the-condarc">
<h5>1.6.4.1&nbsp;&nbsp;&nbsp;Edit the condarc<a class="headerlink" href="#edit-the-condarc" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div><strong>NOTE:</strong> If there are some channels below that you haven&#8217;t mirrored,
you should remove them from the configuration.</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#/opt/wakari/anaconda/.condarc</span>
<span class="n">channels</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">defaults</span>

<span class="n">create_default_packages</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">client</span>
    <span class="o">-</span> <span class="n">python</span>
    <span class="o">-</span> <span class="n">ipython</span><span class="o">-</span><span class="n">we</span>
    <span class="o">-</span> <span class="n">pip</span>

<span class="c1"># Default channels is needed for when users override the system .condarc</span>
<span class="c1"># with ~/.condarc.  This ensures that &quot;defaults&quot; maps to your Anaconda Server and not</span>
<span class="c1"># repo.continuum.io</span>
<span class="n">default_channels</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">wakari</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
    <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="n">channel</span>

<span class="c1"># Note:  You must add the &quot;conda&quot; subdirectory to the end</span>
<span class="n">channel_alias</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span> <span class="n">name</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-anaconda-client">
<h5>1.6.4.2&nbsp;&nbsp;&nbsp;Configure Anaconda Client<a class="headerlink" href="#configure-anaconda-client" title="Permalink to this headline">¶</a></h5>
<p>Anaconda client lets users work with the Anaconda Repository from the command-line.
Things like the following: search for packages, login, upload packages, etc.  The
command below will set this value globally for all users.</p>
<p>Run the following command filling in the proper value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">anaconda</span> <span class="n">config</span> <span class="o">--</span><span class="nb">set</span> <span class="n">url</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">your</span> <span class="n">Anaconda</span> <span class="n">Server</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">api</span> <span class="o">-</span><span class="n">s</span>
</pre></div>
</div>
<p><strong>Congratulations!</strong> You&#8217;ve now successfully installed and configured
Anaconda Enterprise Notebook.</p>
</div>
</div>
</div>
<div class="section" id="pam-authentication-optional">
<h3>1.7&nbsp;&nbsp;&nbsp;PAM Authentication (optional)<a class="headerlink" href="#pam-authentication-optional" title="Permalink to this headline">¶</a></h3>
<p>This documents the process to configure the preliminary PAM authentication mechanism for AEN 4.0.0.</p>
<ol class="arabic">
<li><p class="first">remove <cite>wk-server</cite> from the current <cite>supervisord</cite> set:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">stop</span> <span class="n">wk</span><span class="o">-</span><span class="n">server</span>
<span class="n">mv</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">supervisord</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">wk</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">conf</span>      \
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">supervisord</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">wk</span><span class="o">-</span><span class="n">server</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">SUSPEND</span> \
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">reload</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">install the new package:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">miniconda</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">conda</span> <span class="n">install</span> \
    <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span> \
    <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.10</span><span class="o">.</span><span class="mi">9</span><span class="o">-</span><span class="mf">0.</span><span class="n">tar</span><span class="o">.</span><span class="n">bz2</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">modify the configuration to utilize the new auth method:</p>
<blockquote>
<div><dl class="docutils">
<dt>::</dt>
<dd><p class="first last">vim /opt/wakari/wakari-server/etc/wakari/wk-server-config.json</p>
</dd>
</dl>
<p>change the entry for the line <cite>&#8220;accounts&#8221;:</cite> to read instead:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;accounts&quot;</span><span class="p">:</span> <span class="s2">&quot;wk_server.plugins.accounts.pam&quot;</span><span class="p">,</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">connect the new <cite>initd</cite> script:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span>
<span class="n">chkconfig</span> <span class="o">--</span><span class="n">add</span> <span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span>
<span class="n">service</span> <span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span> <span class="n">start</span>
<span class="n">service</span> <span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">root</span> <span class="n">status</span>
<span class="n">ps</span> <span class="n">aux</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">wk</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">restart/check the <cite>worker</cite> service is running (and only the <cite>worker</cite>) under the <cite>supervisord</cite> watchdog:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">start</span> <span class="nb">all</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">wakari</span><span class="o">/</span><span class="n">wakari</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">status</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
</div>
<span id="document-AnacondaCluster"></span><div class="section" id="anaconda-cluster-runbook">
<h2>1&nbsp;&nbsp;&nbsp;Anaconda Cluster Runbook<a class="headerlink" href="#anaconda-cluster-runbook" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Version: 4.0-3 | Aug 05, 2016</li>
</ul>
<p>Anaconda Cluster is a resource management tool for Anaconda that allows
users to easily create, provision, and manage bare-metal or cloud-based
clusters. It enables management of Conda environments on clusters and
provides integration, configuration, and setup management for Hadoop.
Supported platforms include Amazon Web Services Elastic Compute Cloud
(EC2), physical machines, or even a collection of virtual machines. The
following runbook walks through the steps needed to install Anaconda
Cluster. This runbook is designed for two audiences: those who have
direct access to the internet for installation and those where such
access is not available or restricted for security reasons. For these
restricted a.k.a. &#8220;Air Gap&#8221; environments, Continuum ships the entire
Anaconda product suite on portable storage medium or as a downloadable
TAR archive. Where necessary, additional instructions for Air Gap
environments are noted. If you have any questions about the
instructions, please contact your sales representative or Priority
Support team, if applicable, for additional assistance.</p>
<p>The following runbook walks through the steps needed to install a basic
Anaconda Cluster comprised of a management &#8220;client&#8221; machine and four
cluster nodes:</p>
<ul class="simple">
<li><strong>Client machine:</strong> Where the Anaconda Cluster is configured from.
Typically an IT-managed machine.</li>
<li><strong>Head node (1):</strong> Controls the software, file/folder and environment
state of compute nodes</li>
<li><strong>Compute nodes (3):</strong> Where jobs are run. Managed by the head node.</li>
</ul>
<img alt="_images/cluster.png" class="align-center" src="_images/cluster.png" />
<div class="section" id="requirements">
<h3>1.1&nbsp;&nbsp;&nbsp;Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<div class="section" id="hardware-requirements">
<h4>1.1.1&nbsp;&nbsp;&nbsp;Hardware Requirements<a class="headerlink" href="#hardware-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Client machine<ul>
<li>2+GB RAM, 2+CPU cores</li>
</ul>
</li>
<li>Head and Compute nodes<ul>
<li>8+GB RAM, 8+CPU cores</li>
</ul>
</li>
<li>Storage: Head and Compute nodes<ul>
<li>~1GB for Anaconda Cluster software</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="software-requirements">
<h4>1.1.2&nbsp;&nbsp;&nbsp;Software Requirements<a class="headerlink" href="#software-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>RHEL/CentOS 6.7 (Other operating systems are supported, however this
document assumes RHEL or CentOS 6.7)</li>
<li>Anaconda Repo Server (Anaconda Cloud or local Anaconda Repo)</li>
<li>If using a local Anaconda Repo, Anaconda Cluster channel has been
mirrored to <strong>http://your.anaconda.server:8080/anaconda-cluster</strong></li>
</ul>
</div>
<div class="section" id="linux-system-accounts-required">
<h4>1.1.3&nbsp;&nbsp;&nbsp;Linux System Accounts Required<a class="headerlink" href="#linux-system-accounts-required" title="Permalink to this headline">¶</a></h4>
<p>Some Linux system accounts (UIDs) are added to the system during installation.
If your organization requires special actions, here is the list of UIDs:</p>
<ul class="simple">
<li>salt: created on cluster machines during cluster creation</li>
<li>anaconda: created on cluster machines during cluster creation</li>
</ul>
</div>
<div class="section" id="security-requirements">
<h4>1.1.4&nbsp;&nbsp;&nbsp;Security Requirements<a class="headerlink" href="#security-requirements" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Client machine</li>
<li>Passwordless SSH access to Head and Compute nodes</li>
<li>Head and Cluster nodes</li>
<li>Matching user account/credentials on all nodes with passwordless sudo
enabled</li>
<li>SELinux in Permissive mode</li>
</ul>
</div>
<div class="section" id="network-requirements">
<h4>1.1.5&nbsp;&nbsp;&nbsp;Network Requirements<a class="headerlink" href="#network-requirements" title="Permalink to this headline">¶</a></h4>
<div class="section" id="tcp-ports">
<h5>1.1.5.1&nbsp;&nbsp;&nbsp;TCP Ports<a class="headerlink" href="#tcp-ports" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Inbound TCP 22 (SSH) from client machine to all nodes</li>
<li>Inbound TCP 4505,4506 (salt)<ul>
<li>from client machine to all nodes</li>
<li>from Head node to Compute nodes</li>
</ul>
</li>
<li>Outbound TCP 443 from all machines to Anaconda Cloud or local
Anaconda Server</li>
</ul>
</div>
</div>
<div class="section" id="other-requirements">
<h4>1.1.6&nbsp;&nbsp;&nbsp;Other Requirements<a class="headerlink" href="#other-requirements" title="Permalink to this headline">¶</a></h4>
<p>Assuming the above requirements are met, there are no additional
dependencies necessary for Anaconda Repo.</p>
</div>
<div class="section" id="assumptions">
<h4>1.1.7&nbsp;&nbsp;&nbsp;Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>‘<strong>admin</strong>’ user exists on client machine and all cluster nodes</li>
<li>Client machine has an IP address of 172.31.56.123</li>
<li>Head node has an IP address of 172.31.60.133</li>
<li>Cluster nodes have IP addresses of 172.31.55.76, 172.31.55.77 and
172.31.55.78</li>
<li>Those with <strong>Air Gap</strong> installations have already completed the local
<strong>Anaconda Repo</strong> installation and have a working local <strong>Anaconda
Repo</strong> and Anaconda Cluster channel is available at
<strong>http://your.anaconda.server:8080/anaconda-cluster</strong></li>
</ul>
</div>
<div class="section" id="air-gap-vs-regular-installation">
<h4>1.1.8&nbsp;&nbsp;&nbsp;Air Gap vs. Regular Installation<a class="headerlink" href="#air-gap-vs-regular-installation" title="Permalink to this headline">¶</a></h4>
<p>As stated previously, this document contains installation instructions
for two audiences: those with internet access on the destination
server(s) and those who have no access to internet resources. Many of
the steps below have two sections: &#8220;<strong>Air Gap Installation</strong>&#8221; and
&#8220;<strong>Regular Installation</strong>&#8221;. Those without internet access should follow
the <strong>Air Gap Installation</strong> instructions and those with internet access
should follow <strong>Regular Installation</strong> instructions.</p>
</div>
</div>
<div class="section" id="prepare-the-client-machine">
<h3>1.2&nbsp;&nbsp;&nbsp;Prepare the Client Machine<a class="headerlink" href="#prepare-the-client-machine" title="Permalink to this headline">¶</a></h3>
<p>Anaconda Cluster is managed by one or more client machines with the
anaconda-cluster packages installed, along with the cluster
configuration information. The client machine orchestrates the head node
to install packages, run commands and operational tasks on the compute
nodes.</p>
<div class="section" id="create-an-ssh-keypair-as-the-admin-user">
<h4>1.2.1&nbsp;&nbsp;&nbsp;Create an SSH keypair as the admin user<a class="headerlink" href="#create-an-ssh-keypair-as-the-admin-user" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/admin/.ssh/id_rsa):
Created directory &#39;/home/admin/.ssh&#39;.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/admin/.ssh/id_rsa.
Your public key has been saved in /home/admin/.ssh/id_rsa.pub.
The key fingerprint is:
d0:67:26:cd:3f:7c:f1:7e:b1:f4:fb:2b:86:2b:5e:c2 admin@localhost.localdomain
The key&#39;s randomart image is:
+--[ RSA 2048]----+
|                 |
|       . o       |
|      . o *   .  |
|       . = o   o |
|        S   + .o.|
|        .    o..+|
|         E ..  .+|
|         .o. o  o|
|        ....o .o+|
+-----------------+
[admin@localhost ~]$
</pre></div>
</div>
<p><strong>NOTE:</strong> Save the contents of ~admin/.ssh/id_rsa.pub to a text file.</p>
</div>
</div>
<div class="section" id="download-miniconda">
<h3>1.3&nbsp;&nbsp;&nbsp;Download Miniconda<a class="headerlink" href="#download-miniconda" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Air Gap Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s1">&#39;http://your.anaconda.server:8080/static/extras/Miniconda-latest-Linux-x86_64.sh&#39;</span> <span class="o">&gt;</span> <span class="n">Miniconda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s1">&#39;http://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh&#39;</span> <span class="o">&gt;</span> <span class="n">Miniconda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="install-miniconda">
<h3>1.4&nbsp;&nbsp;&nbsp;Install Miniconda<a class="headerlink" href="#install-miniconda" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">Miniconda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<div class="section" id="review-and-accept-the-license-terms">
<h4>1.4.1&nbsp;&nbsp;&nbsp;Review and accept the license terms:<a class="headerlink" href="#review-and-accept-the-license-terms" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>Welcome to Miniconda 3.19.3 (by Continuum Analytics, Inc.)
In order to continue the installation process, please review
the license agreement.
Please, press ENTER to continue.
Do you approve the license terms?
[yes|no] yes
</pre></div>
</div>
</div>
<div class="section" id="accept-the-default-location-or-specify-an-alternative">
<h4>1.4.2&nbsp;&nbsp;&nbsp;Accept the default location or specify an alternative:<a class="headerlink" href="#accept-the-default-location-or-specify-an-alternative" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Miniconda</span> <span class="n">will</span> <span class="n">now</span> <span class="n">be</span> <span class="n">installed</span> <span class="n">into</span> <span class="n">this</span> <span class="n">location</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">miniconda2</span>
<span class="o">-</span><span class="n">Press</span> <span class="n">ENTER</span> <span class="n">to</span> <span class="n">confirm</span> <span class="n">the</span> <span class="n">location</span>
<span class="o">-</span><span class="n">Press</span> <span class="n">CTRL</span><span class="o">-</span><span class="n">C</span> <span class="n">to</span> <span class="n">abort</span> <span class="n">the</span> <span class="n">installation</span>
<span class="o">-</span><span class="n">Or</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">different</span> <span class="n">location</span> <span class="n">below</span>
 <span class="p">[</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">miniconda2</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">Press</span> <span class="n">ENTER</span><span class="p">]</span>
 <span class="n">PREFIX</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">miniconda2</span>
<span class="n">installing</span><span class="p">:</span> <span class="n">python</span><span class="o">-</span><span class="mf">2.7</span><span class="o">.</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span>
<span class="o">...</span>
<span class="n">Python</span> <span class="mf">2.7</span><span class="o">.</span><span class="mi">10</span> <span class="p">::</span> <span class="n">Continuum</span> <span class="n">Analytics</span><span class="p">,</span> <span class="n">Inc</span><span class="o">.</span>
<span class="n">creating</span> <span class="n">default</span> <span class="n">environment</span><span class="o">...</span> <span class="n">installation</span> <span class="n">finished</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="update-the-admin-user-s-path-prepending-home-admin-miniconda2">
<h4>1.4.3&nbsp;&nbsp;&nbsp;Update the admin user&#8217;s path (prepending <strong>/home/admin/miniconda2</strong>):<a class="headerlink" href="#update-the-admin-user-s-path-prepending-home-admin-miniconda2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>Do you wish the installer to prepend the Miniconda install location
to PATH in your /home/admin/.bashrc ?
[yes|no] yes
</pre></div>
</div>
</div>
<div class="section" id="for-the-new-path-changes-to-take-effect-source-your-bashrc-or-start-a-new-bash-shell">
<h4>1.4.4&nbsp;&nbsp;&nbsp;For the new path changes to take effect, “source” your .bashrc or start a new bash shell:<a class="headerlink" href="#for-the-new-path-changes-to-take-effect-source-your-bashrc-or-start-a-new-bash-shell" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">~/.</span><span class="n">bashrc</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="use-conda-to-download-and-install-anaconda-cluster">
<h3>1.5&nbsp;&nbsp;&nbsp;Use conda to download and install Anaconda Cluster<a class="headerlink" href="#use-conda-to-download-and-install-anaconda-cluster" title="Permalink to this headline">¶</a></h3>
<div class="section" id="add-the-anaconda-cluster-and-anaconda-channels">
<h4>1.5.1&nbsp;&nbsp;&nbsp;Add the anaconda-cluster and anaconda channels:<a class="headerlink" href="#add-the-anaconda-cluster-and-anaconda-channels" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>Air Gap Installation:</strong> Install the Anaconda Cluster channel from
the local Anaconda Repo server.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">your</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">server</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
<span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">default_channels</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">your</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">server</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span> <span class="o">--</span><span class="n">system</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>Regular Installation:</strong> Install the Anaconda Cluster channel from
Anaconda Cloud.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">config</span> <span class="o">--</span><span class="n">add</span> <span class="n">channels</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">t</span><span class="o">/</span><span class="n">L8pxtQupjz01</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="install-the-anaconda-cluster-packages">
<h3>1.6&nbsp;&nbsp;&nbsp;Install the anaconda-cluster packages:<a class="headerlink" href="#install-the-anaconda-cluster-packages" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
</pre></div>
</div>
</div>
<div class="section" id="initialize-anaconda-cluster">
<h3>1.7&nbsp;&nbsp;&nbsp;Initialize Anaconda Cluster:<a class="headerlink" href="#initialize-anaconda-cluster" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">acluster</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> this command creates the <strong>~/.acluster</strong> directory</p>
</div>
<div class="section" id="prepare-head-and-compute-nodes">
<h3>1.8&nbsp;&nbsp;&nbsp;Prepare Head and Compute Nodes<a class="headerlink" href="#prepare-head-and-compute-nodes" title="Permalink to this headline">¶</a></h3>
<p>In order to communicate with the Head and Compute nodes, the admin user
needs to be able to SSH to each node without being prompted for a
password. To allow this but still maintain a level of security, we’ll
use public key authentication from the client machine to the nodes.
Additionally, we’ll allow the admin user to execute root level commands
via sudo, in order to install system packages, update system files, etc.
NOTE: The steps below should be repeated on the Head node and all
Compute nodes.</p>
<div class="section" id="import-ssh-public-key">
<h4>1.8.1&nbsp;&nbsp;&nbsp;Import SSH public key<a class="headerlink" href="#import-ssh-public-key" title="Permalink to this headline">¶</a></h4>
<p>Using your editor of choice, copy the contents of
<strong>~admin/.ssh/id_rsa.pub</strong> (from step XYZ above) from the Client
machine to <strong>~/admin/.ssh/authorized_keys</strong></p>
<p>Your <strong>~/admin/.ssh/authorized_keys</strong> will look something like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">~</span><span class="n">admin</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">authorized_keys</span>
<span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="n">AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22</span><span class="o">.....</span>
</pre></div>
</div>
<p>Make sure ~/admin/.ssh/authorized_keys has the proper permissions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chmod</span> <span class="mi">600</span> <span class="o">~</span><span class="n">admin</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">authorized_keys</span>
</pre></div>
</div>
</div>
<div class="section" id="enable-passwordless-sudo">
<h4>1.8.2&nbsp;&nbsp;&nbsp;Enable passwordless sudo<a class="headerlink" href="#enable-passwordless-sudo" title="Permalink to this headline">¶</a></h4>
<p>Add the following line to the bottom of /etc/sudoers to allow the admin
user to run commands via sudo without entering a password:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">admin</span> <span class="n">ALL</span> <span class="o">=</span> <span class="p">(</span><span class="n">ALL</span><span class="p">)</span> <span class="n">NOPASSWD</span><span class="p">:</span> <span class="n">ALL</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configure-the-cluster">
<h3>1.9&nbsp;&nbsp;&nbsp;Configure the Cluster<a class="headerlink" href="#configure-the-cluster" title="Permalink to this headline">¶</a></h3>
<p>An Anaconda Cluster consists of two primary pieces of information; the
cluster profile and the cluster provider. Both of these live within the
~/admin/.acluster directory structure. In a nutshell, the profile
describes the layout of the cluster: number of nodes, user to connect
with, conda channels, plugins to install, etc. The provider describes
<em>how</em> the cluster is provisioned and built; most importantly, cloud vs.
bare-metal.</p>
<div class="section" id="define-a-cluster-configuration">
<h4>1.9.1&nbsp;&nbsp;&nbsp;Define a Cluster Configuration<a class="headerlink" href="#define-a-cluster-configuration" title="Permalink to this headline">¶</a></h4>
<p>We’re going to create a simple cluster configuration using the head node
and 3 compute nodes we configured previously. Create the
~admin/.acluster/profiles.d/demo-cluster.yaml with the following
content:</p>
<ul class="simple">
<li><strong>Air Gap Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">demo</span><span class="o">-</span><span class="n">cluster</span>
<span class="n">provider</span><span class="p">:</span> <span class="n">bare_metal</span>
<span class="n">num_nodes</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">node_id</span><span class="p">:</span> <span class="n">bare</span>
<span class="n">node_type</span><span class="p">:</span> <span class="n">bare</span>
<span class="n">user</span><span class="p">:</span> <span class="n">admin</span>
<span class="n">machines</span><span class="p">:</span>
    <span class="n">head</span><span class="p">:</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">60.133</span>
    <span class="n">compute</span><span class="p">:</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.76</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.77</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.78</span>
<span class="n">conda_channels</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">your</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">server</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span><span class="o">-</span><span class="n">cluster</span>
 <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">your</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">server</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span>
<span class="n">anaconda_url</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">your</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">server</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">static</span><span class="o">/</span><span class="n">extras</span><span class="o">/</span><span class="n">Miniconda</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">default_channels</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">your</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">server</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">anaconda</span>
<span class="n">plugins</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">conda</span><span class="p">:</span>
     <span class="n">install_prefix</span><span class="p">:</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda</span>
     <span class="n">conda_sh</span><span class="p">:</span> <span class="n">false</span>
     <span class="n">conda_acl</span><span class="p">:</span>
       <span class="o">-</span> <span class="n">user1</span>
       <span class="o">-</span> <span class="n">user2</span>
       <span class="o">-</span> <span class="n">user3</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>Regular Installation:</strong></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">demo</span><span class="o">-</span><span class="n">cluster</span>
<span class="n">provider</span><span class="p">:</span> <span class="n">bare_metal</span>
<span class="n">num_nodes</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">node_id</span><span class="p">:</span> <span class="n">bare</span>
<span class="n">node_type</span><span class="p">:</span> <span class="n">bare</span>
<span class="n">user</span><span class="p">:</span> <span class="n">admin</span>
<span class="n">machines</span><span class="p">:</span>
    <span class="n">head</span><span class="p">:</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">60.133</span>
    <span class="n">compute</span><span class="p">:</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.76</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.77</span>
<span class="o">-</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.78</span>
<span class="n">plugins</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">conda</span><span class="p">:</span>
     <span class="n">install_prefix</span><span class="p">:</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda</span>
     <span class="n">conda_sh</span><span class="p">:</span> <span class="n">false</span>
     <span class="n">conda_acl</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span> <span class="n">of</span> <span class="n">users</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Note:</strong> More information about cluster profiles can be found
<a class="reference external" href="https://docs.continuum.io/anaconda-cluster/config-profile">here</a>.</p>
</div>
<div class="section" id="add-the-following-to-admin-acluster-providers-yaml">
<h4>1.9.2&nbsp;&nbsp;&nbsp;Add the following to ~admin/.acluster/providers.yaml:<a class="headerlink" href="#add-the-following-to-admin-acluster-providers-yaml" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bare_metal</span><span class="p">:</span>
  <span class="n">cloud_provider</span><span class="p">:</span> <span class="n">none</span>
  <span class="n">private_key</span><span class="p">:</span> <span class="o">~/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span>
</pre></div>
</div>
<p>More information about cluster providers can be found
<a class="reference external" href="https://docs.continuum.io/anaconda-cluster/config-provider">here</a>.</p>
</div>
</div>
<div class="section" id="create-the-cluster">
<h3>1.10&nbsp;&nbsp;&nbsp;Create the Cluster<a class="headerlink" href="#create-the-cluster" title="Permalink to this headline">¶</a></h3>
<p>Now that the cluster has been defined, we’re ready to create it. Use the
acluster create command to start the cluster. “demo” is the name of the
new cluster and “demo-cluster” is the name of the cluster profile (from
~admin/.acluster/profiles.d/demo-cluster.yaml).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">acluster</span> <span class="n">create</span> <span class="n">demo</span> <span class="o">-</span><span class="n">p</span> <span class="n">demo</span><span class="o">-</span><span class="n">cluster</span>

<span class="n">Creating</span> <span class="n">cluster</span>
<span class="n">No</span> <span class="n">license</span> <span class="n">file</span> <span class="n">found</span> <span class="n">matching</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span><span class="o">/.</span><span class="n">acluster</span><span class="o">/</span><span class="n">cluster</span><span class="o">*.</span><span class="n">lic</span>
<span class="n">Using</span> <span class="n">unlicensed</span> <span class="n">limits</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">existing</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">requested</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Licensed</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">License</span> <span class="ow">is</span> <span class="n">valid</span> <span class="k">for</span> <span class="n">the</span> <span class="n">current</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span><span class="o">.</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Creating</span> <span class="n">new</span> <span class="n">cluster</span> <span class="s2">&quot;demo&quot;</span> <span class="k">with</span> <span class="n">profile</span> <span class="s2">&quot;demo-cluster&quot;</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Creating</span> <span class="mi">4</span> <span class="n">instances</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Checking</span> <span class="n">SSH</span> <span class="n">connection</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Successfully</span> <span class="n">created</span> <span class="n">instances</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Cluster</span> <span class="n">info</span><span class="p">:</span>
    <span class="p">{</span><span class="s1">&#39;ips&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;172.31.60.133&#39;</span><span class="p">,</span> <span class="s1">&#39;172.31.55.76&#39;</span><span class="p">,</span> <span class="s1">&#39;172.31.55.77&#39;</span><span class="p">,</span> <span class="s1">&#39;172.31.55.78&#39;</span><span class="p">],</span>
     <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;admin&#39;</span><span class="p">,</span>
     <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">u&#39;demo&#39;</span><span class="p">}</span>
<span class="n">Saving</span> <span class="n">cluster</span> <span class="n">file</span>
<span class="n">No</span> <span class="n">license</span> <span class="n">file</span> <span class="n">found</span> <span class="n">matching</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span><span class="o">/.</span><span class="n">acluster</span><span class="o">/</span><span class="n">cluster</span><span class="o">*.</span><span class="n">lic</span>
<span class="n">Using</span> <span class="n">unlicensed</span> <span class="n">limits</span><span class="o">.</span>
<span class="n">Cluster</span> <span class="s2">&quot;demo&quot;</span><span class="p">:</span> <span class="mi">4</span> <span class="n">nodes</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">existing</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">requested</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Licensed</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">License</span> <span class="ow">is</span> <span class="n">valid</span> <span class="k">for</span> <span class="n">the</span> <span class="n">current</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span><span class="o">.</span>
<span class="n">Checking</span> <span class="n">ssh</span> <span class="n">connection</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Checking</span> <span class="n">SSH</span> <span class="n">connection</span>
<span class="n">Checking</span> <span class="n">sudo</span>
<span class="n">Bootstraping</span> <span class="n">conda</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Checking</span> <span class="n">conda</span> <span class="n">installation</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Installing</span> <span class="n">miniconda</span>

<span class="n">Syncing</span> <span class="n">formulas</span>

<span class="n">Installing</span> <span class="n">plugin</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">:</span> <span class="n">conda</span>
<span class="n">INFO</span><span class="p">:</span> <span class="n">Disconnecting</span> <span class="kn">from</span> <span class="nn">all</span> <span class="n">active</span> <span class="n">servers</span>
<span class="n">Disconnecting</span> <span class="kn">from</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">60.133</span><span class="o">...</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Disconnecting</span> <span class="kn">from</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.76</span><span class="o">...</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Disconnecting</span> <span class="kn">from</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.77</span><span class="o">...</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Disconnecting</span> <span class="kn">from</span> <span class="mf">172.31</span><span class="o">.</span><span class="mf">55.78</span><span class="o">...</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Done</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>